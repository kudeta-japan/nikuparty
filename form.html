<!doctype html>
<html lang="ja">
<head>
  <!-- Niku Party ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆï¼ˆFormspreeç‰ˆï¼‰
       ãƒ»A/B/C 3ç”»é¢ãƒ»é€²è¡Œãƒ¡ãƒ¼ã‚¿ãƒ¼å›ºå®š(A0/B33/C66) â†’ æˆåŠŸã§100%
       ãƒ»è¡—ã‚³ãƒ³ä»•æ§˜ï¼šå‡ºä¼šã„æº€è¶³åº¦ãƒ»æ¬¡å›ãƒ‹ãƒ¼ã‚ºãªã©
       ãƒ»äººæ•°ã¯2ã€œ6ãƒœã‚¿ãƒ³ ï¼‹ã€Œã²ã¨ã‚Šã€é¸æŠæ™‚ã¯1ã‚’é€ä¿¡
       ãƒ»5æ®µéšã¯ã€Œä½â†â†’é«˜ã€ç›®ç››ï¼‹ãƒ©ã‚¤ãƒ–èª¬æ˜ï¼ˆâ˜…è¡¨ç¤ºï¼‰
       ãƒ»æˆåŠŸç”»é¢ï¼šniku_staff.jpgï¼‹ãŠç¤¼æ–‡ï¼å†å…¥åŠ›ãƒœã‚¿ãƒ³
       ãƒ»ãƒãƒ‹ãƒ¼ãƒãƒƒãƒˆ(sr-only)ã‚’ä¸å¯è¦–ï¼‹ãƒœãƒƒãƒˆæŠ•ç¨¿ã‚’å¼¾ã
  -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ãƒ‹ã‚¯ãƒ‘ãƒ¼ãƒ†ã‚£ ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ</title>
  <meta name="description" content="ãƒ‹ã‚¯ãƒ‘ãƒ¼ãƒ†ã‚£ ã”å‚åŠ è€…ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆï¼ˆæ‰€è¦2ã€œ3åˆ†ãƒ»åŒ¿åï¼‰" />
  <style>
    :root{
      --bg:#080a10; --fg:#f8f8fb; --muted:#b9bfd1; --brand:#ff8a65; --brand2:#ff7043;
      --card:#121520; --accent:#78d3ff; --rose:#ff7ab6; --cbg:#0b1020;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:system-ui, -apple-system, Segoe UI, Roboto, "Hiragino Kaku Gothic ProN", Meiryo, sans-serif;
      background:
        radial-gradient(1200px 800px at 70% -20%, rgba(255,138,101,.10), transparent),
        radial-gradient(1000px 600px at 10% 110%, rgba(120,211,255,.08), transparent),
        var(--bg);
      color:var(--fg);
    }
    .wrap{max-width:960px; margin:0 auto; padding:28px 18px 64px;}
    header{display:flex; align-items:flex-start; justify-content:space-between; gap:16px; margin-bottom:12px}
    .brand{display:flex; align-items:center; gap:12px}
    .logo{width:44px; height:44px; border-radius:12px; background:conic-gradient(from 20deg,var(--brand),var(--brand2)); box-shadow:0 6px 18px rgba(255,138,101,.25);}
    h1{font-size: clamp(1.2rem, 2.4vw, 1.8rem); margin:0}
    .muted{color:var(--muted); font-size:.95rem}

    /* mascot */
    .mascot{position:relative; display:flex; align-items:center; gap:12px}
    .mascot svg{width:96px; filter: drop-shadow(0 10px 28px rgba(255,138,101,.22)); animation: floaty 4s ease-in-out infinite;}
    @keyframes floaty{0%{transform:translateY(0)}50%{transform:translateY(-6px)}100%{transform:translateY(0)}}
    .bubble{position:relative; background:#0f1430; border:1px solid rgba(255,255,255,.10); padding:10px 12px; border-radius:14px; max-width:320px;}
    .bubble:after{content:""; position:absolute; left:-8px; top:22px; border:8px solid transparent; border-right-color:#0f1430; filter:drop-shadow(-1px 0 0 rgba(255,255,255,.1))}
    .bubble strong{color:#ffab91}

    .card{background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.0)); border:1px solid rgba(255,255,255,.06); box-shadow:0 10px 30px rgba(0,0,0,.25); border-radius:22px; padding:18px; margin:16px 0;}

    /* progress */
    .progress-wrap{position:relative;}
    .bar{height:10px; background:#20242c; border-radius:999px; overflow:hidden;}
    .bar>i{display:block; height:100%; width:0%; background:linear-gradient(90deg,var(--brand),var(--brand2)); box-shadow:0 0 22px rgba(255,138,101,.45) inset; transition:width .35s ease}
    .bar .buddy{position:absolute; top:50%; transform:translate(-50%,-50%); width:28px; height:28px; border-radius:50%; background:radial-gradient(circle at 30% 30%, #ffe0b2, #ff7043); box-shadow:0 8px 18px rgba(255,138,101,.35); border:2px solid #2a2210}
    .bar .buddy:after{content:"ğŸ¥©"; position:absolute; inset:0; display:grid; place-items:center; font-size:16px}
    .progress-caption{display:flex; justify-content:space-between; align-items:center; margin-top:6px; font-size:.92rem; color:var(--muted)}

    /* inputs */
    .grid{display:grid; gap:12px}
    .two{grid-template-columns:repeat(2, minmax(0,1fr));}
    @media (max-width: 720px){ .two{grid-template-columns:1fr;} }
    label{display:block; font-weight:700; margin:6px 0 8px}
    .help{color:var(--muted); font-size:.9rem}
    .opt{display:flex; gap:10px; flex-wrap:wrap}
    .opt input[type="radio"], .opt input[type="checkbox"]{display:none}
    .opt label{border:1px solid rgba(255,255,255,.14); padding:12px 14px; border-radius:14px; cursor:pointer; background:#101217; transition:.15s transform, .2s box-shadow}
    .opt label:hover{transform:translateY(-1px)}
    .opt input:checked + label{outline:2px solid var(--brand); background:linear-gradient(180deg,rgba(255,138,101,.12),transparent); box-shadow:0 0 0 6px rgba(255,138,101,.10)}
    select, input[type="text"], textarea{ width:100%; background:#101217; color:#f8f8fb; border:1px solid rgba(255,255,255,.12); border-radius:12px; padding:12px 14px; font-size:1rem; outline:none; }
    textarea{min-height:120px; line-height:1.5}

    .btns{display:flex; gap:10px; flex-wrap:wrap}
    button{cursor:pointer; border:0; padding:12px 16px; border-radius:14px; font-weight:800; transition:transform .08s ease}
    .primary{background:linear-gradient(135deg,var(--brand),var(--brand2)); color:#202020}
    .ghost{background:transparent; color:#fff; border:1px solid rgba(255,255,255,.14)}
    button:active{transform:translateY(1px) scale(.99)}

    .section-badge{display:inline-flex; align-items:center; gap:8px; padding:6px 10px; border-radius:999px; background:#101217; border:1px solid rgba(255,255,255,.12); font-size:.85rem; margin-bottom:8px}
    .section-badge--c{background:#0f1426; border-color:rgba(120,211,255,.3); box-shadow:0 0 0 2px rgba(120,211,255,.15) inset}

    .step{display:none}
    .step.active{display:block; animation: fadeIn .22s ease}
    @keyframes fadeIn{from{opacity:0; transform:translateY(6px)} to{opacity:1; transform:translateY(0)}}

    /* Cç”»é¢å¼·èª¿ */
    .step[data-step="3"]{--stripe1:linear-gradient(180deg,var(--accent),#9ad9ff); --stripe2:linear-gradient(180deg,#ffa8d2,var(--rose)); --stripe3:linear-gradient(180deg,#ffd761,#ffb300);}
    .cgroup{background:var(--cbg); border:1px solid rgba(255,255,255,.10); border-radius:16px; padding:14px; position:relative; box-shadow:0 6px 20px rgba(0,0,0,.25);}
    .cgroup:before{content:""; position:absolute; left:-1px; top:-1px; bottom:-1px; width:6px; border-radius:16px 0 0 16px; background:var(--stripe1);}
    .cgroup.alt1:before{ background:var(--stripe2); }
    .cgroup.alt2:before{ background:var(--stripe3); }
    .step[data-step="3"] .opt label{ background:#0f1528; border-color:rgba(120,211,255,.22);}
    .step[data-step="3"] .opt input:checked + label{ outline-color:#9ad9ff; background:linear-gradient(180deg,rgba(120,211,255,.18),transparent); box-shadow:0 0 0 6px rgba(120,211,255,.12)}
    .step[data-step="3"] label{ color:#e8f3ff }
    .hint{color:#a3c9ff; font-size:.9rem}
    .divider{height:1px;background:linear-gradient(90deg,transparent,rgba(120,211,255,.35),transparent); margin:6px 0 2px}

    /* 5æ®µéšè¡¨ç¤º */
    .scale-hint{display:flex;justify-content:space-between;align-items:center;font-size:.88rem;color:var(--muted);margin:-2px 0 6px}
    .opt.scale label{min-width:38px;text-align:center}
    .now-hint{margin-top:6px;color:var(--muted);font-size:.9rem}
    .now-hint b{color:#ffcc80}

    /* ãƒãƒ‹ãƒ¼ãƒãƒƒãƒˆ */
    .sr-only{
      position:absolute !important;
      width:1px;height:1px;padding:0;margin:-1px;
      overflow:hidden;clip:rect(0,0,0,0);
      white-space:nowrap;border:0;
    }

    .foot{font-size:.85rem;margin-top:4px}
    .confetti span{
      position:fixed; top:-10px; font-size:20px; animation:fall linear forwards;
      pointer-events:none; z-index:50;
    }
    @keyframes fall{
      to{transform:translate3d(var(--x,0),105vh,0) rotate(360deg); opacity:0;}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>ãƒ‹ã‚¯ãƒ‘ãƒ¼ãƒ†ã‚£ ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ</h1>
          <div class="muted">æ‰€è¦ <b>2ã€œ3åˆ†</b>ï¼åŒ¿åãƒ»ä¸€éƒ¨ä»»æ„</div>
        </div>
      </div>
      <div class="mascot" aria-live="polite">
        <!-- ğŸ¥© ãƒã‚¹ã‚³ãƒƒãƒˆ -->
        <svg viewBox="0 0 160 140" aria-hidden="true">
          <defs>
            <radialGradient id="meatGrad" cx="35%" cy="30%" r="75%">
              <stop offset="0%" stop-color="#ffe0b2"/><stop offset="100%" stop-color="#ff7043"/>
            </radialGradient>
          </defs>
          <ellipse cx="80" cy="90" rx="40" ry="32" fill="url(#meatGrad)" stroke="#5d2a16" stroke-width="4"/>
          <circle cx="80" cy="90" r="18" fill="#ffab91" stroke="#ffccbc" stroke-width="3"/>
          <circle cx="68" cy="78" r="4" fill="#5d2a16"/>
          <circle cx="92" cy="78" r="4" fill="#5d2a16"/>
          <path d="M70 102 Q80 108 90 102" stroke="#5d2a16" stroke-width="4" fill="none" stroke-linecap="round"/>
          <circle cx="62" cy="88" r="3" fill="#ff8a80"/>
          <circle cx="98" cy="88" r="3" fill="#ff8a80"/>
          <line x1="60" y1="118" x2="54" y2="136" stroke="#5d2a16" stroke-width="4">
            <animate attributeName="y2" values="136;132;136" dur="1.2s" repeatCount="indefinite"/>
          </line>
          <line x1="100" y1="118" x2="106" y2="136" stroke="#5d2a16" stroke-width="4">
            <animate attributeName="y2" values="136;140;136" dur="1.2s" repeatCount="indefinite"/>
          </line>
        </svg>
        <div class="bubble" id="bubble">ã‚ˆã†ã“ãï¼ã¾ãšã¯<strong>A</strong>ã‹ã‚‰ã€‚å…¨éƒ¨ã§3ç”»é¢ã ã‚ˆğŸ¥©</div>
      </div>
    </header>

    <div class="card">
      <div class="progress-wrap">
        <div class="bar"><i id="progress"></i><i class="buddy" id="buddy" style="left:0%"></i></div>
        <div class="progress-caption"><span id="captionLeft">A. å…¨ä½“è©•ä¾¡ / æ®‹ã‚Š2ç”»é¢</span><span id="captionRight">0%</span></div>
      </div>

      <form id="form" class="grid" novalidate>
        <!-- ğŸ”’ honeypot (ä¸å¯è¦–) -->
        <input type="text" name="website" autocomplete="off" class="sr-only" tabindex="-1" aria-hidden="true">
        <input type="hidden" name="timestamp" id="timestamp">
        <input type="hidden" name="source" id="source">
        <input type="hidden" name="form_version" value="niku_party_v1">

        <!-- A -->
        <section class="step active" data-step="1">
          <div class="section-badge">A. å…¨ä½“è©•ä¾¡</div>
          <div class="grid two">
            <!-- å…¨ä½“ã®æº€è¶³åº¦ -->
            <div>
              <label>æœ¬æ—¥ã®ã‚¤ãƒ™ãƒ³ãƒˆå…¨ä½“ã®æº€è¶³åº¦ï¼ˆ1ã€œ5ï¼‰</label>
              <div class="scale-hint"><span>ä½ï¼ˆä¸æº€ï¼‰</span><span>é«˜ï¼ˆã¨ã¦ã‚‚æº€è¶³ï¼‰</span></div>
              <div class="opt scale" role="radiogroup" aria-label="æº€è¶³åº¦">
                <input type="radio" id="csat1" name="csat" value="1" required><label for="csat1">1</label>
                <input type="radio" id="csat2" name="csat" value="2"><label for="csat2">2</label>
                <input type="radio" id="csat3" name="csat" value="3"><label for="csat3">3</label>
                <input type="radio" id="csat4" name="csat" value="4"><label for="csat4">4</label>
                <input type="radio" id="csat5" name="csat" value="5"><label for="csat5">5</label>
              </div>
              <div class="now-hint" id="csatNow">é¸æŠï¼šâ€”ï¼ˆ<span>1=ä¸æº€ / 5=ã¨ã¦ã‚‚æº€è¶³</span>ï¼‰</div>
            </div>

            <!-- å‹äººã«å‹§ã‚ãŸã„åº¦ -->
            <div>
              <label>å‹äººã«ãƒ‹ã‚¯ãƒ‘ãƒ¼ãƒ†ã‚£ã‚’å‹§ã‚ãŸã„åº¦ï¼ˆ1ã€œ5ï¼‰</label>
              <div class="scale-hint"><span>å‹§ã‚ãªã„</span><span>ã¨ã¦ã‚‚å‹§ã‚ãŸã„</span></div>
              <div class="opt scale" role="radiogroup" aria-label="å‹§ã‚ãŸã„åº¦">
                <input type="radio" id="nps1" name="nps" value="1" required><label for="nps1">1</label>
                <input type="radio" id="nps2" name="nps" value="2"><label for="nps2">2</label>
                <input type="radio" id="nps3" name="nps" value="3"><label for="nps3">3</label>
                <input type="radio" id="nps4" name="nps" value="4"><label for="nps4">4</label>
                <input type="radio" id="nps5" name="nps" value="5"><label for="nps5">5</label>
              </div>
              <div class="now-hint" id="npsNow">é¸æŠï¼šâ€”ï¼ˆ<span>1=å‹§ã‚ãªã„ / 5=ã¨ã¦ã‚‚å‹§ã‚ãŸã„</span>ï¼‰</div>
            </div>

            <div>
              <label>æ¬¡å›ã®ãƒ‹ã‚¯ãƒ‘ãƒ¼ãƒ†ã‚£ã«ã‚‚å‚åŠ ã—ãŸã„ã§ã™ã‹ï¼Ÿ</label>
              <div class="opt">
                <input type="radio" id="rejoin_yes" name="rejoin" value="ãœã²å‚åŠ ã—ãŸã„" required><label for="rejoin_yes">ãœã²å‚åŠ ã—ãŸã„</label>
                <input type="radio" id="rejoin_maybe" name="rejoin" value="äºˆå®šãŒåˆãˆã°å‚åŠ ã—ãŸã„"><label for="rejoin_maybe">äºˆå®šãŒåˆãˆã°å‚åŠ ã—ãŸã„</label>
                <input type="radio" id="rejoin_no" name="rejoin" value="ãŸã¶ã‚“å‚åŠ ã—ãªã„"><label for="rejoin_no">ãŸã¶ã‚“å‚åŠ ã—ãªã„</label>
              </div>
            </div>
            <div>
              <label>å‚åŠ è²»ã®ç´å¾—æ„Ÿ</label>
              <div class="opt">
                <input type="radio" id="price1" name="price_fairness" value="é«˜ã™ãã‚‹" required><label for="price1">é«˜ã™ãã‚‹</label>
                <input type="radio" id="price2" name="price_fairness" value="ã‚„ã‚„é«˜ã„"><label for="price2">ã‚„ã‚„é«˜ã„</label>
                <input type="radio" id="price3" name="price_fairness" value="ã¡ã‚‡ã†ã©ã‚ˆã„"><label for="price3">ã¡ã‚‡ã†ã©ã‚ˆã„</label>
                <input type="radio" id="price4" name="price_fairness" value="ã‚„ã‚„å®‰ã„"><label for="price4">ã‚„ã‚„å®‰ã„</label>
                <input type="radio" id="price5" name="price_fairness" value="å®‰ã™ãã‚‹"><label for="price5">å®‰ã™ãã‚‹</label>
              </div>
            </div>
          </div>

          <!-- ä»»æ„ï¼šå„è¦ç´  -->
          <div class="grid two" style="margin-top:6px">
            <div>
              <label>è‚‰æ–™ç†ã®æº€è¶³åº¦ï¼ˆä»»æ„ï¼‰</label>
              <div class="scale-hint"><span>ä½ã„</span><span>é«˜ã„</span></div>
              <div class="opt scale" role="radiogroup" aria-label="è‚‰æ–™ç†æº€è¶³åº¦">
                <input type="radio" id="meat1" name="meat_quality" value="1"><label for="meat1">1</label>
                <input type="radio" id="meat2" name="meat_quality" value="2"><label for="meat2">2</label>
                <input type="radio" id="meat3" name="meat_quality" value="3"><label for="meat3">3</label>
                <input type="radio" id="meat4" name="meat_quality" value="4"><label for="meat4">4</label>
                <input type="radio" id="meat5" name="meat_quality" value="5"><label for="meat5">5</label>
              </div>
              <div class="now-hint" id="meatNow">é¸æŠï¼šâ€”ï¼ˆ<span>1=ã‚¤ãƒã‚¤ãƒ / 5=æœ€é«˜ï¼</span>ï¼‰</div>
            </div>
            <div>
              <label>å‡ºä¼šã„ãƒ»ä¼šè©±ã®æº€è¶³åº¦ï¼ˆä»»æ„ï¼‰</label>
              <div class="scale-hint"><span>ä½ã„</span><span>é«˜ã„</span></div>
              <div class="opt scale" role="radiogroup" aria-label="å‡ºä¼šã„æº€è¶³åº¦">
                <input type="radio" id="meet1" name="meet_satisfaction" value="1"><label for="meet1">1</label>
                <input type="radio" id="meet2" name="meet_satisfaction" value="2"><label for="meet2">2</label>
                <input type="radio" id="meet3" name="meet_satisfaction" value="3"><label for="meet3">3</label>
                <input type="radio" id="meet4" name="meet_satisfaction" value="4"><label for="meet4">4</label>
                <input type="radio" id="meet5" name="meet_satisfaction" value="5"><label for="meet5">5</label>
              </div>
              <div class="now-hint" id="meetNow">é¸æŠï¼šâ€”ï¼ˆ<span>1=ã‚¤ãƒã‚¤ãƒ / 5=æœ€é«˜ï¼</span>ï¼‰</div>
            </div>
            <div>
              <label>ä¼šå ´ã®é›°å›²æ°—ï¼ˆä»»æ„ï¼‰</label>
              <div class="scale-hint"><span>ä½ã„</span><span>é«˜ã„</span></div>
              <div class="opt scale" role="radiogroup" aria-label="é›°å›²æ°—">
                <input type="radio" id="env1" name="env_atmosphere" value="1"><label for="env1">1</label>
                <input type="radio" id="env2" name="env_atmosphere" value="2"><label for="env2">2</label>
                <input type="radio" id="env3" name="env_atmosphere" value="3"><label for="env3">3</label>
                <input type="radio" id="env4" name="env_atmosphere" value="4"><label for="env4">4</label>
                <input type="radio" id="env5" name="env_atmosphere" value="5"><label for="env5">5</label>
              </div>
              <div class="now-hint" id="envNow">é¸æŠï¼šâ€”ï¼ˆ<span>1=ã‚¤ãƒã‚¤ãƒ / 5=æœ€é«˜ï¼</span>ï¼‰</div>
            </div>
            <div>
              <label>ã‚¹ã‚¿ãƒƒãƒ•ã®å¯¾å¿œï¼ˆä»»æ„ï¼‰</label>
              <div class="scale-hint"><span>ä½ã„</span><span>é«˜ã„</span></div>
              <div class="opt scale" role="radiogroup" aria-label="ã‚¹ã‚¿ãƒƒãƒ•ã®å¯¾å¿œ">
                <input type="radio" id="svc1" name="staff_hospitality" value="1"><label for="svc1">1</label>
                <input type="radio" id="svc2" name="staff_hospitality" value="2"><label for="svc2">2</label>
                <input type="radio" id="svc3" name="staff_hospitality" value="3"><label for="svc3">3</label>
                <input type="radio" id="svc4" name="staff_hospitality" value="4"><label for="svc4">4</label>
                <input type="radio" id="svc5" name="staff_hospitality" value="5"><label for="svc5">5</label>
              </div>
              <div class="now-hint" id="svcNow">é¸æŠï¼šâ€”ï¼ˆ<span>1=ã‚¤ãƒã‚¤ãƒ / 5=æœ€é«˜ï¼</span>ï¼‰</div>
            </div>
          </div>

          <div class="btns"><button type="button" class="primary" data-next>æ¬¡ã¸ï¼ˆBã¸é€²ã‚€ï¼‰</button></div>
        </section>

        <!-- B -->
        <section class="step" data-step="2">
          <div class="section-badge">B. ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è©•ä¾¡ï¼ˆ1ã€œ5ï¼‰</div>
          <div class="grid two">
            <div>
              <label>è‚‰æ–™ç†ï¼ˆã‚¹ãƒ†ãƒ¼ã‚­ãƒ»ãƒ­ãƒ¼ã‚¹ãƒˆãƒ“ãƒ¼ãƒ•ãªã©ï¼‰</label>
              <div class="scale-hint"><span>ä½ã„</span><span>é«˜ã„</span></div>
              <div class="opt scale" role="radiogroup" aria-label="è‚‰æ–™ç†è©•ä¾¡">
                <input type="radio" id="cont_meat1" name="content_meat" value="1" required><label for="cont_meat1">1</label>
                <input type="radio" id="cont_meat2" name="content_meat" value="2"><label for="cont_meat2">2</label>
                <input type="radio" id="cont_meat3" name="content_meat" value="3"><label for="cont_meat3">3</label>
                <input type="radio" id="cont_meat4" name="content_meat" value="4"><label for="cont_meat4">4</label>
                <input type="radio" id="cont_meat5" name="content_meat" value="5"><label for="cont_meat5">5</label>
              </div>
              <div class="now-hint" id="contMeatNow">é¸æŠï¼šâ€”ï¼ˆ<span>1=ã‚¤ãƒã‚¤ãƒ / 5=æœ€é«˜ï¼</span>ï¼‰</div>
            </div>

            <div>
              <label>ãƒ‰ãƒªãƒ³ã‚¯ï¼ˆã‚¢ãƒ«ã‚³ãƒ¼ãƒ«ãƒ»ã‚½ãƒ•ãƒˆãƒ‰ãƒªãƒ³ã‚¯ï¼‰</label>
              <div class="scale-hint"><span>ä½ã„</span><span>é«˜ã„</span></div>
              <div class="opt scale" role="radiogroup" aria-label="ãƒ‰ãƒªãƒ³ã‚¯è©•ä¾¡">
                <input type="radio" id="cont_drink1" name="content_drink" value="1" required><label for="cont_drink1">1</label>
                <input type="radio" id="cont_drink2" name="content_drink" value="2"><label for="cont_drink2">2</label>
                <input type="radio" id="cont_drink3" name="content_drink" value="3"><label for="cont_drink3">3</label>
                <input type="radio" id="cont_drink4" name="content_drink" value="4"><label for="cont_drink4">4</label>
                <input type="radio" id="cont_drink5" name="content_drink" value="5"><label for="cont_drink5">5</label>
              </div>
              <div class="now-hint" id="contDrinkNow">é¸æŠï¼šâ€”ï¼ˆ<span>1=ã‚¤ãƒã‚¤ãƒ / 5=æœ€é«˜ï¼</span>ï¼‰</div>
            </div>

            <div>
              <label>ã‚°ãƒ«ãƒ¼ãƒ—ãƒˆãƒ¼ã‚¯ã®æ™‚é–“</label>
              <div class="scale-hint"><span>ä½ã„</span><span>é«˜ã„</span></div>
              <div class="opt scale" role="radiogroup" aria-label="ã‚°ãƒ«ãƒ¼ãƒ—ãƒˆãƒ¼ã‚¯è©•ä¾¡">
                <input type="radio" id="cont_group1" name="content_group_talk" value="1" required><label for="cont_group1">1</label>
                <input type="radio" id="cont_group2" name="content_group_talk" value="2"><label for="cont_group2">2</label>
                <input type="radio" id="cont_group3" name="content_group_talk" value="3"><label for="cont_group3">3</label>
                <input type="radio" id="cont_group4" name="content_group_talk" value="4"><label for="cont_group4">4</label>
                <input type="radio" id="cont_group5" name="content_group_talk" value="5"><label for="cont_group5">5</label>
              </div>
              <div class="now-hint" id="contGroupNow">é¸æŠï¼šâ€”ï¼ˆ<span>1=ã‚¤ãƒã‚¤ãƒ / 5=æœ€é«˜ï¼</span>ï¼‰</div>
            </div>

            <div>
              <label>1å¯¾1ãƒˆãƒ¼ã‚¯ã®æ™‚é–“</label>
              <div class="scale-hint"><span>çŸ­ã™ããƒ»è©±ã—ã«ãã„</span><span>ã¡ã‚‡ã†ã©ã‚ˆã„ãƒ»è©±ã—ã‚„ã™ã„</span></div>
              <div class="opt scale" role="radiogroup" aria-label="1å¯¾1ãƒˆãƒ¼ã‚¯è©•ä¾¡">
                <input type="radio" id="cont_one1" name="content_one_talk" value="1" required><label for="cont_one1">1</label>
                <input type="radio" id="cont_one2" name="content_one_talk" value="2"><label for="cont_one2">2</label>
                <input type="radio" id="cont_one3" name="content_one_talk" value="3"><label for="cont_one3">3</label>
                <input type="radio" id="cont_one4" name="content_one_talk" value="4"><label for="cont_one4">4</label>
                <input type="radio" id="cont_one5" name="content_one_talk" value="5"><label for="cont_one5">5</label>
              </div>
              <div class="now-hint" id="contOneNow">é¸æŠï¼šâ€”ï¼ˆ<span>1=ã‚¤ãƒã‚¤ãƒ / 5=æœ€é«˜ï¼</span>ï¼‰</div>
            </div>

            <div>
              <label>ãƒãƒƒãƒãƒ³ã‚°ãƒ»æŠ•ç¥¨ã®ã‚ã‹ã‚Šã‚„ã™ã•</label>
              <div class="scale-hint"><span>ã‚ã‹ã‚Šã«ãã„</span><span>ã¨ã¦ã‚‚ã‚ã‹ã‚Šã‚„ã™ã„</span></div>
              <div class="opt scale" role="radiogroup" aria-label="ãƒãƒƒãƒãƒ³ã‚°è©•ä¾¡">
                <input type="radio" id="cont_match1" name="content_matching" value="1" required><label for="cont_match1">1</label>
                <input type="radio" id="cont_match2" name="content_matching" value="2"><label for="cont_match2">2</label>
                <input type="radio" id="cont_match3" name="content_matching" value="3"><label for="cont_match3">3</label>
                <input type="radio" id="cont_match4" name="content_matching" value="4"><label for="cont_match4">4</label>
                <input type="radio" id="cont_match5" name="content_matching" value="5"><label for="cont_match5">5</label>
              </div>
              <div class="now-hint" id="contMatchNow">é¸æŠï¼šâ€”ï¼ˆ<span>1=ã‚¤ãƒã‚¤ãƒ / 5=æœ€é«˜ï¼</span>ï¼‰</div>
            </div>
          </div>

          <div class="grid" style="margin-top:10px">
            <label>è‰¯ã‹ã£ãŸã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®é †ä½ï¼ˆé‡è¤‡ä¸å¯ï¼‰</label>
            <div class="two">
              <div><span class="help">1ä½</span>
                <select id="rank1" name="favorite_rank_1" required>
                  <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                  <option>è‚‰æ–™ç†</option>
                  <option>ãƒ‰ãƒªãƒ³ã‚¯</option>
                  <option>ã‚°ãƒ«ãƒ¼ãƒ—ãƒˆãƒ¼ã‚¯</option>
                  <option>1å¯¾1ãƒˆãƒ¼ã‚¯</option>
                  <option>ãƒãƒƒãƒãƒ³ã‚°ãƒ»æŠ•ç¥¨</option>
                </select>
              </div>
              <div><span class="help">2ä½</span>
                <select id="rank2" name="favorite_rank_2" required>
                  <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                  <option>è‚‰æ–™ç†</option>
                  <option>ãƒ‰ãƒªãƒ³ã‚¯</option>
                  <option>ã‚°ãƒ«ãƒ¼ãƒ—ãƒˆãƒ¼ã‚¯</option>
                  <option>1å¯¾1ãƒˆãƒ¼ã‚¯</option>
                  <option>ãƒãƒƒãƒãƒ³ã‚°ãƒ»æŠ•ç¥¨</option>
                </select>
              </div>
              <div><span class="help">3ä½</span>
                <select id="rank3" name="favorite_rank_3" required>
                  <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                  <option>è‚‰æ–™ç†</option>
                  <option>ãƒ‰ãƒªãƒ³ã‚¯</option>
                  <option>ã‚°ãƒ«ãƒ¼ãƒ—ãƒˆãƒ¼ã‚¯</option>
                  <option>1å¯¾1ãƒˆãƒ¼ã‚¯</option>
                  <option>ãƒãƒƒãƒãƒ³ã‚°ãƒ»æŠ•ç¥¨</option>
                </select>
              </div>
            </div>
          </div>

          <div class="grid" style="margin-top:10px">
            <label>ç‰¹ã«è‰¯ã‹ã£ãŸç‚¹ãƒ»ã‚‚ã£ã¨ã“ã†ã—ã¦ã»ã—ã„ç‚¹ï¼ˆä»»æ„ï¼‰</label>
            <textarea name="good_and_improve" placeholder="ä¾‹ï¼šè‚‰ã®ç„¼ãåŠ æ¸›ãŒã¡ã‚‡ã†ã©è‰¯ã‹ã£ãŸï¼ãƒˆãƒ¼ã‚¯æ™‚é–“ã‚’ã‚‚ã†å°‘ã—é•·ãã—ã¦ã»ã—ã„ ãªã©"></textarea>
          </div>

          <div class="btns"><button type="button" class="ghost" data-prev>æˆ»ã‚‹</button><button type="button" class="primary" data-next>æ¬¡ã¸ï¼ˆCã¸ï¼‰</button></div>
        </section>

        <!-- C -->
        <section class="step" data-step="3">
          <div class="section-badge section-badge--c">C. æ¥åº—å‹•æ©Ÿãƒ»æ¬¡å›ãƒ‹ãƒ¼ã‚ºãƒ»å±æ€§ï¼ˆæœ€çµ‚ç”»é¢ï¼‰</div>

          <div class="grid">
            <div class="cgroup alt2">
              <label>å‚åŠ ã—ãŸç†ç”±ï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰ <span class="hint">â€» ã‚ã¦ã¯ã¾ã‚‹ã‚‚ã®ã‚’ã™ã¹ã¦</span></label>
              <div class="divider"></div>
              <div class="opt">
                <input type="checkbox" id="mot1" name="visit_motivation" value="æ‹äººãƒ»ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã‚’è¦‹ã¤ã‘ãŸã‹ã£ãŸ"><label for="mot1">æ‹äººãƒ»ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã‚’è¦‹ã¤ã‘ãŸã‹ã£ãŸ</label>
                <input type="checkbox" id="mot2" name="visit_motivation" value="å‹ã ã¡ãƒ»é£²ã¿ä»²é–“ã‚’å¢—ã‚„ã—ãŸã‹ã£ãŸ"><label for="mot2">å‹ã ã¡ãƒ»é£²ã¿ä»²é–“ã‚’å¢—ã‚„ã—ãŸã‹ã£ãŸ</label>
                <input type="checkbox" id="mot3" name="visit_motivation" value="è‚‰ãƒ»ã‚°ãƒ«ãƒ¡ã‚¤ãƒ™ãƒ³ãƒˆã¨ã—ã¦èˆˆå‘³ãŒã‚ã£ãŸ"><label for="mot3">è‚‰ãƒ»ã‚°ãƒ«ãƒ¡ã‚¤ãƒ™ãƒ³ãƒˆã¨ã—ã¦èˆˆå‘³ãŒã‚ã£ãŸ</label>
                <input type="checkbox" id="mot4" name="visit_motivation" value="SNSã®æŠ•ç¨¿ãŒæ¥½ã—ãã†ã ã£ãŸ"><label for="mot4">SNSã®æŠ•ç¨¿ãŒæ¥½ã—ãã†ã ã£ãŸ</label>
                <input type="checkbox" id="mot5" name="visit_motivation" value="å‹äººã«èª˜ã‚ã‚Œã¦"><label for="mot5">å‹äººã«èª˜ã‚ã‚Œã¦</label>
                <input type="checkbox" id="mot6" name="visit_motivation" value="é–‹å‚¬æ™‚é–“ãƒ»å ´æ‰€ãŒã¡ã‚‡ã†ã©è‰¯ã‹ã£ãŸ"><label for="mot6">é–‹å‚¬æ™‚é–“ãƒ»å ´æ‰€ãŒã¡ã‚‡ã†ã©è‰¯ã‹ã£ãŸ</label>
                <input type="checkbox" id="mot7" name="visit_motivation" value="ã¨ã‚Šã‚ãˆãšé¢ç™½ãã†ã ã£ãŸã‹ã‚‰"><label for="mot7">ã¨ã‚Šã‚ãˆãšé¢ç™½ãã†ã ã£ãŸã‹ã‚‰</label>
                <input type="checkbox" id="mot_etc" name="visit_motivation" value="ãã®ä»–"><label for="mot_etc">ãã®ä»–</label>
              </div>
              <input type="text" id="mot_etc_text" name="visit_motivation_other" placeholder="ãã®ä»–ï¼ˆã‚ˆã‚ã—ã‘ã‚Œã°ç†ç”±ã‚’ï¼‰" style="margin-top:8px; display:none">
            </div>

            <div class="cgroup">
              <label>ãƒ‹ã‚¯ãƒ‘ãƒ¼ãƒ†ã‚£ã‚’çŸ¥ã£ãŸãã£ã‹ã‘</label>
              <div class="divider"></div>
              <div class="opt">
                <input type="radio" id="aw1" name="awareness_channel" value="LINE"><label for="aw1">KU-DETAå…¬å¼LINE</label>
                <input type="radio" id="aw2" name="awareness_channel" value="Instagram"><label for="aw2">Instagram</label>
                <input type="radio" id="aw3" name="awareness_channel" value="çŸ¥äººç´¹ä»‹"><label for="aw3">çŸ¥äººç´¹ä»‹</label>
                <input type="radio" id="aw4" name="awareness_channel" value="æ¥åº—æ™‚ã®æ¡ˆå†…"><label for="aw4">æ¥åº—æ™‚ã®æ¡ˆå†…</label>
                <input type="radio" id="aw5" name="awareness_channel" value="ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ãƒ»æ¤œç´¢"><label for="aw5">ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ãƒ»æ¤œç´¢</label>
                <input type="radio" id="aw6" name="awareness_channel" value="ãã®ä»–"><label for="aw6">ãã®ä»–</label>
              </div>
              <input type="text" id="awareness_other" name="awareness_channel_other" placeholder="ãã®ä»–ï¼ˆè‡ªç”±è¨˜è¿°ï¼‰" style="margin-top:8px; display:none">
            </div>

            <div class="cgroup alt2">
              <label>æ¬¡å›ã‚ã£ãŸã‚‰è¡ŒããŸã„ãƒ†ãƒ¼ãƒï¼ˆè¤‡æ•°å¯ï¼‰</label>
              <div class="divider"></div>
              <div class="opt">
                <input type="checkbox" id="theme_light" name="next_theme" value="å°‘äººæ•°ã‚†ã£ãã‚Šãƒˆãƒ¼ã‚¯ä¼š"><label for="theme_light">å°‘äººæ•°ã‚†ã£ãã‚Šãƒˆãƒ¼ã‚¯ä¼š</label>
                <input type="checkbox" id="theme_big" name="next_theme" value="å¤§äººæ•°ã‚ã„ã‚ã„ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼"><label for="theme_big">å¤§äººæ•°ã‚ã„ã‚ã„ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼</label>
                <input type="checkbox" id="theme_meat" name="next_theme" value="è‚‰ã‚¬ãƒå‹¢å‘ã‘ãƒ»èµ¤èº«ã‚¹ãƒ†ãƒ¼ã‚­ä¼š"><label for="theme_meat">è‚‰ã‚¬ãƒå‹¢å‘ã‘ãƒ»èµ¤èº«ã‚¹ãƒ†ãƒ¼ã‚­ä¼š</label>
                <input type="checkbox" id="theme_wine" name="next_theme" value="ãƒ¯ã‚¤ãƒ³&è‚‰ãƒšã‚¢ãƒªãƒ³ã‚°ä¼š"><label for="theme_wine">ãƒ¯ã‚¤ãƒ³&è‚‰ãƒšã‚¢ãƒªãƒ³ã‚°ä¼š</label>
                <input type="checkbox" id="theme_beginner" name="next_theme" value="åˆå‚åŠ ãƒ»ãŠã²ã¨ã‚Šæ§˜ä¸­å¿ƒä¼š"><label for="theme_beginner">åˆå‚åŠ ãƒ»ãŠã²ã¨ã‚Šæ§˜ä¸­å¿ƒä¼š</label>
                <input type="checkbox" id="theme_age" name="next_theme" value="å¹´ä»£åˆ¥ï¼ˆä¾‹ï¼š20ä»£ãƒ»30ä»£å‘ã‘ï¼‰"><label for="theme_age">å¹´ä»£åˆ¥ï¼ˆä¾‹ï¼š20ä»£ãƒ»30ä»£å‘ã‘ï¼‰</label>
                <input type="checkbox" id="theme_other" name="next_theme" value="ãã®ä»–"><label for="theme_other">ãã®ä»–</label>
              </div>
              <input type="text" id="theme_other_text" name="theme_other_text" placeholder="ãã®ä»–ï¼ˆè‡ªç”±è¨˜è¿°ï¼‰" style="margin-top:8px; display:none">
            </div>

            <div class="two">
              <div class="cgroup alt1">
                <label>é–‹å‚¬ã®å¸Œæœ›æ™‚é–“å¸¯</label>
                <div class="divider"></div>
                <div class="opt">
                  <input type="radio" id="pt1" name="preferred_time" value="å¹³æ—¥å¤œ"><label for="pt1">å¹³æ—¥å¤œ</label>
                  <input type="radio" id="pt2" name="preferred_time" value="åœŸæ›œå¤œ"><label for="pt2">åœŸæ›œå¤œ</label>
                  <input type="radio" id="pt3" name="preferred_time" value="æ—¥æ›œæ˜¼"><label for="pt3">æ—¥æ›œæ˜¼</label>
                  <input type="radio" id="pt4" name="preferred_time" value="ç¥æ—¥å‰å¤œ"><label for="pt4">ç¥æ—¥å‰å¤œ</label>
                  <input type="radio" id="pt5" name="preferred_time" value="ãã®ä»–"><label for="pt5">ãã®ä»–</label>
                </div>
                <input type="text" id="preferred_time_other" name="preferred_time_other" placeholder="ãã®ä»–ï¼ˆè‡ªç”±è¨˜è¿°ï¼‰" style="margin-top:8px; display:none">
              </div>
              <div class="cgroup">
                <label>å¸Œæœ›ã™ã‚‹ä¾¡æ ¼å¸¯</label>
                <div class="divider"></div>
                <div class="opt">
                  <input type="radio" id="pp3" name="preferred_price" value="3,000å††å°"><label for="pp3">3,000å††å°</label>
                  <input type="radio" id="pp4" name="preferred_price" value="4,000å††å°"><label for="pp4">4,000å††å°</label>
                  <input type="radio" id="pp5" name="preferred_price" value="5,000å††å°"><label for="pp5">5,000å††å°</label>
                  <input type="radio" id="pp6" name="preferred_price" value="6,000å††å°"><label for="pp6">6,000å††å°</label>
                  <input type="radio" id="pp8" name="preferred_price" value="8,000å††ä»¥ä¸Š"><label for="pp8">8,000å††ä»¥ä¸Š</label>
                </div>
              </div>
            </div>

            <div class="cgroup alt2">
              <label>åŒä¼´è€…ãƒ»äººæ•°ãƒ»å¹´ä»£ãƒ»æ€§åˆ¥</label>
              <div class="divider"></div>
              <div class="two">
                <div>
                  <div class="opt" style="margin-bottom:8px">
                    <input type="radio" id="p1" name="companion_type" value="ã²ã¨ã‚Š"><label for="p1">ã²ã¨ã‚Š</label>
                    <input type="radio" id="p2" name="companion_type" value="å‹äººã¨"><label for="p2">å‹äººã¨</label>
                    <input type="radio" id="p3" name="companion_type" value="è·å ´ä»²é–“ã¨"><label for="p3">è·å ´ä»²é–“ã¨</label>
                    <input type="radio" id="p4" name="companion_type" value="å®¶æ—ã¨"><label for="p4">å®¶æ—ã¨</label>
                    <input type="radio" id="p5" name="companion_type" value="ãã®ä»–"><label for="p5">ãã®ä»–</label>
                  </div>
                  <input type="text" id="party_other" name="companion_type_other" placeholder="ãã®ä»–ï¼ˆè‡ªç”±è¨˜è¿°ï¼‰" style="display:none">
                </div>
                <div>
                  <label class="help">æ¥å ´äººæ•°ï¼ˆè‡ªã‚°ãƒ«ãƒ¼ãƒ—ï¼‰</label>
                  <div class="opt" id="group_size_wrap">
                    <input type="radio" id="gs2" name="group_size" value="2"><label for="gs2">2</label>
                    <input type="radio" id="gs3" name="group_size" value="3"><label for="gs3">3</label>
                    <input type="radio" id="gs4" name="group_size" value="4"><label for="gs4">4</label>
                    <input type="radio" id="gs5" name="group_size" value="5"><label for="gs5">5</label>
                    <input type="radio" id="gs6" name="group_size" value="6"><label for="gs6">6</label>
                  </div>

                  <label class="help" style="margin-top:10px">å¹´ä»£ï¼ˆä»»æ„ï¼‰</label>
                  <div class="opt">
                    <input type="radio" id="age20" name="age" value="20ä»£"><label for="age20">20ä»£</label>
                    <input type="radio" id="age30" name="age" value="30ä»£"><label for="age30">30ä»£</label>
                    <input type="radio" id="age40" name="age" value="40ä»£"><label for="age40">40ä»£</label>
                    <input type="radio" id="age50" name="age" value="50ä»£"><label for="age50">50ä»£</label>
                    <input type="radio" id="age60" name="age" value="60ä»£ä»¥ä¸Š"><label for="age60">60ä»£ä»¥ä¸Š</label>
                  </div>

                  <label class="help" style="margin-top:10px">æ€§åˆ¥ï¼ˆä»»æ„ï¼‰</label>
                  <div class="opt">
                    <input type="radio" id="g_m" name="gender" value="ç”·æ€§"><label for="g_m">ç”·æ€§</label>
                    <input type="radio" id="g_f" name="gender" value="å¥³æ€§"><label for="g_f">å¥³æ€§</label>
                    <input type="radio" id="g_o" name="gender" value="ãã®ä»–ãƒ»å›ç­”ã—ãªã„"><label for="g_o">ãã®ä»–ãƒ»å›ç­”ã—ãªã„</label>
                  </div>
                </div>
              </div>
            </div>

            <div class="cgroup alt1">
              <label>ã”è¦æœ›ãƒ»ã”æ„è¦‹ãƒ»ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆä»»æ„ï¼‰</label>
              <div class="divider"></div>
              <textarea id="feedback" name="feedback" placeholder="é‹å–¶ã¸ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚„ã€ã‚‚ã£ã¨ã“ã†ãªã£ãŸã‚‰å¬‰ã—ã„ï¼ã¨ã„ã†ã“ã¨ãŒã‚ã‚Œã°ãœã²æ•™ãˆã¦ãã ã•ã„ã€‚"></textarea>
            </div>
          </div>

          <div class="btns"><button type="button" class="ghost" data-prev>æˆ»ã‚‹</button><button type="submit" class="primary">é€ä¿¡ã™ã‚‹</button></div>
        </section>
      </form>
    </div>

    <div id="result" class="card" style="display:none"></div>
    <div class="foot muted">åŒ¿åã§ã®ã”å”åŠ›ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚å…¥åŠ›å†…å®¹ã¯ãƒ‹ã‚¯ãƒ‘ãƒ¼ãƒ†ã‚£ãŠã‚ˆã³KU-DETAã®æ”¹å–„ãƒ»å“è³ªå‘ä¸Šã®ç›®çš„ã§ã®ã¿åˆ©ç”¨ã—ã¾ã™ã€‚</div>
  </div>

  <div class="confetti" id="confetti" aria-hidden="true"></div>

  <script>
    // âœ… Formspreeã®URLã‚’è‡ªåˆ†ã®ãƒ•ã‚©ãƒ¼ãƒ IDã«å¤‰æ›´ã—ã¦ãã ã•ã„
    const FORMSPREE_ENDPOINT = "https://formspree.io/f/xxxxxxxx";

    const steps = Array.from(document.querySelectorAll('.step'));
    let idx = 0;
    const progress = document.getElementById('progress');
    const buddy = document.getElementById('buddy');
    const capL = document.getElementById('captionLeft');
    const capR = document.getElementById('captionRight');
    const bubble = document.getElementById('bubble');

    // å›ºå®šãƒ¡ãƒ¼ã‚¿ãƒ¼: A=0, B=33, C=66ï¼ˆé€ä¿¡æˆåŠŸã§100ï¼‰
    const pctByStep = [0, 33, 66];
    const captions = [
      {l:'A. å…¨ä½“è©•ä¾¡ / æ®‹ã‚Š2ç”»é¢', b:'ã¾ãšã¯ä»Šæ—¥ã®æº€è¶³åº¦ã‚’æ•™ãˆã¦ã­ğŸ¥©'},
      {l:'B. ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è©•ä¾¡ / æ®‹ã‚Š1ç”»é¢', b:'ã„ã„æ„Ÿã˜ï¼ç‰¹ã«ã©ã†ã ã£ãŸã‹æ•™ãˆã¦ã»ã—ã„ğŸ”¥'},
      {l:'C. æ¥åº—å‹•æ©Ÿã»ã‹ / æœ€çµ‚ç”»é¢', b:'ã“ã“ãŒæœ€å¾Œï¼ã€Œé€ä¿¡ã€ã§å®Œäº†âœ¨'}
    ];

    // === 5æ®µéš ãƒ©ã‚¤ãƒ–è¡¨ç¤º ===
    const csatText = {1:'ã¨ã¦ã‚‚ä¸æº€',2:'ã‚„ã‚„ä¸æº€',3:'ãµã¤ã†',4:'æº€è¶³',5:'ã¨ã¦ã‚‚æº€è¶³'};
    const npsText  = {1:'å‹§ã‚ãªã„',2:'ã‚ã¾ã‚Šå‹§ã‚ãªã„',3:'ã©ã¡ã‚‰ã¨ã‚‚è¨€ãˆãªã„',4:'å‹§ã‚ãŸã„',5:'ã¨ã¦ã‚‚å‹§ã‚ãŸã„'};
    const attrText = {1:'ã‚¤ãƒã‚¤ãƒ',2:'ã‚„ã‚„ç‰©è¶³ã‚Šãªã„',3:'ãµã¤ã†',4:'è‰¯ã‹ã£ãŸ',5:'æœ€é«˜ï¼'};

    const csatNow = document.getElementById('csatNow');
    const npsNow  = document.getElementById('npsNow');
    const meatNow = document.getElementById('meatNow');
    const meetNow = document.getElementById('meetNow');
    const envNow  = document.getElementById('envNow');
    const svcNow  = document.getElementById('svcNow');
    const contMeatNow   = document.getElementById('contMeatNow');
    const contDrinkNow  = document.getElementById('contDrinkNow');
    const contGroupNow  = document.getElementById('contGroupNow');
    const contOneNow    = document.getElementById('contOneNow');
    const contMatchNow  = document.getElementById('contMatchNow');

    function stars(n){ return 'â˜…'.repeat(n) + 'â˜†'.repeat(5-n); }
    function bindLiveHint(name, hintEl, dict){
      document.querySelectorAll(`input[name="${name}"]`).forEach(r=>{
        r.addEventListener('change', ()=>{
          const v = Number(document.querySelector(`input[name="${name}"]:checked`)?.value || r.value);
          hintEl.innerHTML = `é¸æŠï¼š<b>${stars(v)}</b>ï¼ˆ${dict[v]}ï¼‰`;
        });
      });
    }
    bindLiveHint('csat', csatNow, csatText);
    bindLiveHint('nps',  npsNow,  npsText);
    bindLiveHint('meat_quality',   meatNow, attrText);
    bindLiveHint('meet_satisfaction', meetNow, attrText);
    bindLiveHint('env_atmosphere', envNow, attrText);
    bindLiveHint('staff_hospitality', svcNow, attrText);
    bindLiveHint('content_meat',        contMeatNow, attrText);
    bindLiveHint('content_drink',       contDrinkNow, attrText);
    bindLiveHint('content_group_talk',  contGroupNow, attrText);
    bindLiveHint('content_one_talk',    contOneNow, attrText);
    bindLiveHint('content_matching',    contMatchNow, attrText);

    function confettiBurst(n=36){
      const root = document.getElementById('confetti');
      for(let i=0;i<n;i++){
        const s = document.createElement('span');
        s.textContent = Math.random()>.4 ? 'ğŸ¥©' : (Math.random()>.5?'âœ¨':'â­ï¸');
        s.style.left = Math.random()*100 + 'vw';
        s.style.setProperty('--x', (Math.random()*200-100)+'px');
        s.style.animationDuration = (1.2+Math.random()*0.8)+'s';
        root.appendChild(s);
        setTimeout(()=> s.remove(), 1800);
      }
    }

    function updateProgress(){
      const pct = pctByStep[idx] ?? 0;
      progress.style.width = pct + '%';
      buddy.style.left = pct + '%';
      capL.textContent = captions[idx].l;
      capR.textContent = `${pct}%`;
      bubble.innerHTML = captions[idx].b;
    }

    function goto(i){
      steps[idx].classList.remove('active');
      idx = i; steps[idx].classList.add('active');
      updateProgress();
      const firstInput = steps[idx].querySelector('input, select, textarea, button');
      if(firstInput) firstInput.focus({preventScroll:false});
      window.scrollTo({top:0, behavior:'smooth'});
    }

    // æ¬¡ã¸ï¼æˆ»ã‚‹
    document.querySelectorAll('[data-next]').forEach(b=>b.addEventListener('click', ()=>{
      const required = steps[idx].querySelectorAll('[required]');
      for(const el of required){
        if(el.type==='radio'){
          const name = el.name;
          if(!steps[idx].querySelector(`input[name="${name}"]:checked`)){
            steps[idx].classList.add('error'); setTimeout(()=>steps[idx].classList.remove('error'), 800); return;
          }
        } else if(el.tagName==='SELECT' && !el.value){
          steps[idx].classList.add('error'); setTimeout(()=>steps[idx].classList.remove('error'), 800); return;
        }
      }
      if(idx===0 || idx===1) confettiBurst(18);
      goto(Math.min(idx+1, steps.length-1));
    }));
    document.querySelectorAll('[data-prev]').forEach(b=>b.addEventListener('click', ()=> goto(Math.max(idx-1, 0))));

    // åˆæœŸãƒ¡ã‚¿
    document.getElementById('timestamp').value = new Date().toISOString();
    const params = new URLSearchParams(location.search);
    document.getElementById('source').value = params.get('ch') || params.get('utm_source') || '';

    // ã€Œãã®ä»–ã€è¡¨ç¤ºåˆ‡æ›¿
    function toggleEtc(triggerId, inputId){
      const t = document.getElementById(triggerId); const i = document.getElementById(inputId);
      function u(){ const on = !!t.checked; i.style.display = on ? 'block' : 'none'; if(!on) i.value=''; }
      t.addEventListener('change', u); u();
    }
    ['mot_etc:mot_etc_text','theme_other:theme_other_text','pt5:preferred_time_other','p5:party_other','aw6:awareness_other']
      .forEach(pair=>{ const [t,i]=pair.split(':'); toggleEtc(t,i); });

    // é †ä½ã®é‡è¤‡é˜²æ­¢
    const selects = ['rank1','rank2','rank3'].map(id=>document.getElementById(id));
    function refreshOptions(){
      const chosen = new Set(selects.map(s=>s.value).filter(Boolean));
      selects.forEach(s=>{
        Array.from(s.options).forEach(o=>{ if(!o.value) return; o.disabled = !o.selected && chosen.has(o.value); });
      });
    }
    selects.forEach(s=> s.addEventListener('change', refreshOptions));

    // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡
    const form = document.getElementById('form');
    form.addEventListener('submit', async (e)=>{
      e.preventDefault();

      // ğŸ”’ ãƒãƒ‹ãƒ¼ãƒãƒƒãƒˆ
      const honey = form.querySelector('input[name="website"]');
      if (honey && honey.value.trim() !== '') { return; }

      const requiredNames = [
        'csat','nps','rejoin','price_fairness',
        'content_meat','content_drink','content_group_talk','content_one_talk','content_matching'
      ];
      for(const n of requiredNames){
        if(!form.querySelector(`[name="${n}"]:checked`)){
          alert('æœªå›ç­”ã®å¿…é ˆé …ç›®ãŒã‚ã‚Šã¾ã™');
          goto(n.startsWith('content_') ? 1 : 0);
          return;
        }
      }
      // é †ä½å¿…é ˆ
      for(const id of ['rank1','rank2','rank3']){
        if(!document.getElementById(id).value){
          alert('è‰¯ã‹ã£ãŸã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®é †ä½ã‚’é¸æŠã—ã¦ãã ã•ã„');
          goto(1);
          return;
        }
      }
      const [r1,r2,r3] = selects.map(s=>s.value);
      if(new Set([r1,r2,r3]).size<3){
        alert('1ä½ãƒ»2ä½ãƒ»3ä½ã¯é‡è¤‡ã—ãªã„ã‚ˆã†é¸ã‚“ã§ãã ã•ã„');
        goto(1);
        return;
      }

      const data = new FormData(form);
      // ã€Œã²ã¨ã‚Šã€ãªã‚‰ group_size=1 ã‚’å¼·åˆ¶
      if(data.get('companion_type') === 'ã²ã¨ã‚Š'){ data.set('group_size','1'); }

      try{
        const res = await fetch(FORMSPREE_ENDPOINT, { method:'POST', body:data, headers:{ 'Accept':'application/json' }});
        if(res.ok){
          document.querySelector('.card').style.display='none';
          const result = document.getElementById('result');
          result.style.display='block';

          progress.style.width = '100%'; buddy.style.left = '100%';
          capL.textContent = 'é€ä¿¡å®Œäº† / ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼'; capR.textContent = '100%';
          bubble.innerHTML = 'ã‚ã‚ŠãŒã¨ã†ï¼ã‚ãªãŸã®å£°ã‚’å—ã‘å–ã‚Šã¾ã—ãŸğŸ‰';

          result.innerHTML = `
            <h2 style="margin:0 0 10px">ã”å›ç­”ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼</h2>
            <img src="menu_roastbeef.jpg" alt="ãƒ‹ã‚¯ãƒ‘ãƒ¼ãƒ†ã‚£ ã‚¹ã‚¿ãƒƒãƒ•" style="width:100%;max-width:640px;border-radius:16px;display:block;margin:6px 0 14px;object-fit:cover">
            <div style="background:#0f1426;border:1px solid rgba(255,255,255,.14);border-radius:16px;padding:16px 14px;line-height:1.9;box-shadow:0 6px 20px rgba(0,0,0,.25);">
              <p>ãƒ‹ã‚¯ãƒ‘ãƒ¼ãƒ†ã‚£ã«ã”å‚åŠ ã„ãŸã ãã€æœ¬å½“ã«ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚</p>
              <p>ã„ãŸã ã„ãŸãŠå£°ã¯ã€æ¬¡å›ä»¥é™ã®ä¼ç”»ã‚„é€²è¡Œã€æ–™ç†ãƒ»ã‚µãƒ¼ãƒ“ã‚¹ã®æ”¹å–„ã«ã—ã£ã‹ã‚Šæ´»ã‹ã—ã¦ã„ãã¾ã™ã€‚</p>
              <p>ã€ŒãŠè‚‰ã¨å‡ºä¼šã„ã€ã©ã¡ã‚‰ã‚‚æ¥½ã—ã‚ã‚‹å ´æ‰€ã€ã«è‚²ã¦ã¦ã„ã‘ã‚‹ã‚ˆã†ã€ã‚¹ã‚¿ãƒƒãƒ•ä¸€åŒãƒãƒ£ãƒ¬ãƒ³ã‚¸ã‚’ç¶šã‘ã¦ã„ãã¾ã™ã€‚</p>
              <p>ã‚ˆã‘ã‚Œã°ã€ã¾ãŸæ¬¡å›ã®ãƒ‹ã‚¯ãƒ‘ãƒ¼ãƒ†ã‚£ã‚„KU-DETAã®é€šå¸¸å–¶æ¥­ã«ã‚‚éŠã³ã«æ¥ã¦ã„ãŸã ã‘ãŸã‚‰å¬‰ã—ã„ã§ã™ã€‚</p>
              <p>ã“ã‚Œã‹ã‚‰ã‚‚KU-DETAã‚’ã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚</p>
            </div>
            <div class="btns" style="margin-top:12px">
              <button type="button" class="ghost" id="againBtn">ã‚‚ã†ä¸€åº¦å›ç­”ã™ã‚‹</button>
            </div>
          `;

          (function(){const root=document.getElementById('confetti'); for(let i=0;i<60;i++){const s=document.createElement('span'); s.textContent = Math.random()>.4 ? 'ğŸ¥©' : (Math.random()>.5?'âœ¨':'â­ï¸'); s.style.left = Math.random()*100 + 'vw'; s.style.setProperty('--x', (Math.random()*200-100)+'px'); s.style.animationDuration = (1.2+Math.random()*0.8)+'s'; root.appendChild(s); setTimeout(()=> s.remove(), 1800);} })();

          document.getElementById('againBtn')?.addEventListener('click', ()=>{
            form.reset();
            refreshOptions();
            ['mot_etc_text','awareness_other','theme_other_text','preferred_time_other','party_other']
              .forEach(id=>{ const el=document.getElementById(id); if(el){ el.value=''; el.style.display='none'; } });
            // ãƒ©ã‚¤ãƒ–è¡¨ç¤ºåˆæœŸåŒ–
            csatNow.innerHTML = 'é¸æŠï¼šâ€”ï¼ˆ<span>1=ä¸æº€ / 5=ã¨ã¦ã‚‚æº€è¶³</span>ï¼‰';
            npsNow.innerHTML  = 'é¸æŠï¼šâ€”ï¼ˆ<span>1=å‹§ã‚ãªã„ / 5=ã¨ã¦ã‚‚å‹§ã‚ãŸã„</span>ï¼‰';
            meatNow.innerHTML = 'é¸æŠï¼šâ€”ï¼ˆ<span>1=ã‚¤ãƒã‚¤ãƒ / 5=æœ€é«˜ï¼</span>ï¼‰';
            meetNow.innerHTML = 'é¸æŠï¼šâ€”ï¼ˆ<span>1=ã‚¤ãƒã‚¤ãƒ / 5=æœ€é«˜ï¼</span>ï¼‰';
            envNow.innerHTML  = 'é¸æŠï¼šâ€”ï¼ˆ<span>1=ã‚¤ãƒã‚¤ãƒ / 5=æœ€é«˜ï¼</span>ï¼‰';
            svcNow.innerHTML  = 'é¸æŠï¼šâ€”ï¼ˆ<span>1=ã‚¤ãƒã‚¤ãƒ / 5=æœ€é«˜ï¼</span>ï¼‰';
            contMeatNow.innerHTML  = 'é¸æŠï¼šâ€”ï¼ˆ<span>1=ã‚¤ãƒã‚¤ãƒ / 5=æœ€é«˜ï¼</span>ï¼‰';
            contDrinkNow.innerHTML = 'é¸æŠï¼šâ€”ï¼ˆ<span>1=ã‚¤ãƒã‚¤ãƒ / 5=æœ€é«˜ï¼</span>ï¼‰';
            contGroupNow.innerHTML = 'é¸æŠï¼šâ€”ï¼ˆ<span>1=ã‚¤ãƒã‚¤ãƒ / 5=æœ€é«˜ï¼</span>ï¼‰';
            contOneNow.innerHTML   = 'é¸æŠï¼šâ€”ï¼ˆ<span>1=ã‚¤ãƒã‚¤ãƒ / 5=æœ€é«˜ï¼</span>ï¼‰';
            contMatchNow.innerHTML = 'é¸æŠï¼šâ€”ï¼ˆ<span>1=ã‚¤ãƒã‚¤ãƒ / 5=æœ€é«˜ï¼</span>ï¼‰';

            document.getElementById('timestamp').value = new Date().toISOString();
            result.style.display='none';
            document.querySelector('.card').style.display='block';
            goto(0);
            window.scrollTo({top:0, behavior:'smooth'});
          });

        } else {
          const payload = await res.json().catch(()=>({}));
          throw new Error(payload?.error || 'é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸã€‚æ™‚é–“ã‚’ç½®ã„ã¦ãŠè©¦ã—ãã ã•ã„ã€‚');
        }
      } catch(err){ alert(err.message); }
    });

    function init(){ updateProgress(); refreshOptions(); }
    init();
  </script>
</body>
</html>
