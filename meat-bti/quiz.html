<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Meat BTI è¨ºæ–­ï½œè¦‹ã‚„ã™ã„5æ®µéš Ã— 20å•</title>
<meta name="description" content="Aå¯„ã‚Šã€œBå¯„ã‚Šã®5æ®µéšã§20å•ã«ç­”ãˆã‚‹ã ã‘ã€‚ã‚ãªãŸã®â€œè‚‰ã‚¿ã‚¤ãƒ—â€ã¨ç›¸æ€§No.1ï¼è¦æ³¨æ„ã‚¿ã‚¤ãƒ—ã‚’è¨ºæ–­ã€‚">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-V39MNGQD5H"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){ dataLayer.push(arguments); }
  gtag('js', new Date()); gtag('config', 'G-V39MNGQD5H');
</script>
<style>
  :root{
    --bg:#0a0d14; --panel:#0f1524; --ink:#f7fbff; --muted:#b8c6da; --bd:#1b2640;
    --cheese:#ffd966; --tomato:#ff6b4a; --blue:#57a6ff; --ok:#2ed39b; --warn:#ffd166;
    --chip:#111a31; --chip-bd:#27355a; --shadow:0 14px 34px rgba(0,0,0,.35);
    --tap:#151f39; --tap-bd:#2a3963;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;background:var(--bg);color:var(--ink);
    font-family: system-ui,-apple-system,"Segoe UI",Roboto,"Hiragino Kaku Gothic ProN","Meiryo",sans-serif;
    letter-spacing:.02em; line-height:1.75;
  }
  a{color:inherit;text-decoration:none}
  .wrap{min-height:100dvh;display:grid;grid-template-rows:auto 1fr auto}
  header{position:sticky;top:0;z-index:20;background:rgba(13,18,32,.85);backdrop-filter:saturate(120%) blur(8px);border-bottom:1px solid var(--bd)}
  .head-in{width:min(980px,92vw);margin:0 auto;height:60px;display:flex;align-items:center;justify-content:space-between;gap:10px}
  .brand{display:flex;align-items:center;gap:12px}
  .logo{width:34px;height:34px;border-radius:10px;background:conic-gradient(from 140deg,var(--cheese),var(--tomato));display:grid;place-items:center;color:#111;font-weight:900}
  .brand b{font-size:18px}
  .btn{appearance:none;border:1px solid var(--bd);background:#14203a;color:var(--ink);padding:12px 16px;border-radius:12px;font-weight:800;cursor:pointer;transition:transform .06s ease}
  .btn:hover{transform:translateY(-1px)}
  .btn.primary{background:linear-gradient(180deg,var(--tomato),#ff4a2c);color:#111;border:none}
  .btn.ghost{background:transparent}
  .main{width:min(980px,92vw);margin:0 auto;padding:14px 0 28px}
  .card{background:var(--panel);border:1px solid var(--bd);border-radius:18px;box-shadow:var(--shadow);overflow:hidden}

  /* progress */
  .progress{display:grid;grid-template-columns:auto 1fr auto;align-items:center;gap:14px;padding:12px 14px;border-bottom:1px solid var(--bd)}
  .bar{height:10px;background:#0e1730;border:1px solid var(--bd);border-radius:999px;overflow:hidden}
  .bar>div{height:100%;width:0%;background:linear-gradient(90deg,var(--cheese),var(--tomato))}
  .meta{font-size:13px;color:#ced9ec}
  .pgdots{display:flex;gap:8px}
  .dot{width:9px;height:9px;border-radius:999px;background:#283b65;border:1px solid #3a528a;opacity:.7}
  .dot.active{background:#86b7ff;opacity:1}

  /* quiz grid */
  .qwrap{padding:16px 16px 18px}
  .grid5{display:grid;grid-template-columns:1fr;gap:14px}
  @media(min-width:900px){ .grid5{grid-template-columns:1fr 1fr} }

  .qcard{
    border:1px solid #203159;background:#0e172d;border-radius:14px;padding:14px;
    display:flex;flex-direction:column;gap:10px;
  }
  .qcard.focus{outline:2px solid #2f77ff;outline-offset:0}
  .qnum{font-weight:900;font-size:14px;color:#aecdff;letter-spacing:.06em}
  .qhead{font-weight:900;margin:0;font-size:clamp(16px,4.6vw,18px)}
  .qtext{margin:0;color:#dbe7ff}
  .anchors{display:flex;justify-content:space-between;gap:10px;align-items:center}
  .chip{background:var(--chip);border:1px solid var(--chip-bd);padding:6px 10px;border-radius:999px;font-size:12px;color:#d7e2fa}
  .chip A{color:inherit}
  .ab{display:flex;gap:8px;align-items:center}
  .ab .A,.ab .B{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;border:1px solid var(--chip-bd);background:#0e1730;font-size:12px}
  .ab .A::before{content:"A";display:inline-grid;place-items:center;width:18px;height:18px;border-radius:999px;background:#133860;color:#cfe5ff;font-weight:900}
  .ab .B::before{content:"B";display:inline-grid;place-items:center;width:18px;height:18px;border-radius:999px;background:#5d1a0f;color:#ffe1d9;font-weight:900}

  /* 5-scale buttons */
  .scale{display:grid;grid-template-columns:repeat(5,1fr);gap:8px}
  .cell{
    display:grid;gap:4px;place-items:center;padding:12px 4px;height:56px;
    background:var(--tap);border:1px solid var(--tap-bd);border-radius:12px;cursor:pointer;user-select:none;
  }
  .cell strong{font-size:14px;line-height:1}
  .cell small{font-size:10px;color:#c3d1ea;opacity:.9}
  .cell[data-sel="1"]{outline:2px solid var(--cheese);background:#172443}

  /* footer of page */
  .page-foot{display:flex;justify-content:space-between;align-items:center;margin-top:12px;flex-wrap:wrap;gap:8px}
  .pill{display:inline-flex;gap:6px;align-items:center;padding:6px 12px;border-radius:999px;background:var(--chip);border:1px solid var(--chip-bd);font-size:12px;color:#d7e2fa}
  .remain{font-size:13px;color:#ced9ec}

  /* result */
  .result{display:grid;gap:16px}
  .r-hero{display:grid;grid-template-columns:1fr 1.2fr;gap:14px}
  @media(max-width:900px){.r-hero{grid-template-columns:1fr}}
  .r-img{aspect-ratio:1/1;border:1px solid #21345f;background:#0b1224;border-radius:14px;overflow:hidden}
  .r-img img{width:100%;height:100%;object-fit:cover}
  .rtype{font-size:clamp(22px,5.6vw,28px);font-weight:900;margin:0}
  .rone{margin:8px 0 0;color:#e8f0ff}
  .r-tags{margin-top:10px;display:flex;flex-wrap:wrap;gap:8px}
  .tag{padding:6px 10px;border:1px solid #2a3b6c;border-radius:999px;background:#101a35;font-size:12px}
  .r-pairs{display:grid;gap:6px;margin-top:10px}
  .pair{display:flex;gap:8px;align-items:center}
  .badge{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;border:1px solid #364a83;background:#0f1834;font-size:12px}
  footer{border-top:1px solid var(--bd);color:#9fb0cc;font-size:12px;text-align:center;padding:16px}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="head-in">
      <div class="brand"><div class="logo">ğŸ¥©</div><b>Meat BTI è¨ºæ–­</b></div>
      <a class="btn ghost" href="../index.html">â† LPã¸æˆ»ã‚‹</a>
    </div>
  </header>

  <main class="main">
    <!-- QUIZ -->
    <section class="card" id="quizCard" aria-label="è¨ºæ–­">
      <div class="progress">
        <div class="meta"><b id="answered">0</b>/20</div>
        <div class="bar"><div id="bar"></div></div>
        <div class="pgdots" aria-hidden="true">
          <span class="dot" id="dot1"></span><span class="dot" id="dot2"></span>
          <span class="dot" id="dot3"></span><span class="dot" id="dot4"></span>
        </div>
      </div>

      <div class="qwrap">
        <div id="qGrid" class="grid5"><!-- 5å•ã‚’æç”» --></div>

        <div class="page-foot">
          <span class="pill">ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆï¼š<code>1</code>ã€œ<code>5</code>ï¼ˆé¸ã¶ã¨æ¬¡ã¸ï¼‰</span>
          <div style="display:flex;gap:8px">
            <button class="btn" id="prevPage">å‰ã®5å•</button>
            <button class="btn primary" id="nextPage" disabled>æ¬¡ã®5å•ã¸</button>
          </div>
        </div>
        <div class="remain" id="remainTxt">æ®‹ã‚Š 20 å•</div>
      </div>
    </section>

    <!-- RESULT -->
    <section class="card" id="resultCard" hidden aria-label="çµæœ">
      <div class="qwrap result">
        <div class="r-hero">
          <div class="r-img"><img id="rImg" alt=""></div>
          <div>
            <h2 class="rtype" id="rType">â€”</h2>
            <p class="rone" id="rOne">â€”</p>
            <div class="r-tags" id="rTags"></div>

            <div class="r-pairs">
              <div class="pair"><span class="badge">ğŸ¯ ç›¸æ€§No.1</span><b id="bestMate">â€”</b></div>
              <div class="pair"><span class="badge" style="border-color:#7d5a20;background:#241a0b">âš  è¦æ³¨æ„</span><b id="caution">â€”</b></div>
            </div>

            <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:12px">
              <button class="btn" id="retryBtn">ã‚‚ã†ä¸€åº¦</button>
              <button class="btn" id="saveBtn">çµæœã‚’ä¿å­˜(JSON)</button>
              <a class="btn primary" href="../index.html">LPã¸æˆ»ã‚‹</a>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer>Â© <span id="y"></span> Meat BTI</footer>
</div>

<script>
  /* ==== è¨­å®šï¼ˆè»¸ï¼‰ ==== */
  const AXES = ['rich','adv','tempo','social','texture'];

  /* ==== 12ã‚¿ã‚¤ãƒ—ï¼ˆä½ç½®ãƒ™ã‚¯ãƒˆãƒ«ãƒ»ä¸€è¨€ãƒ»ç›¸æ€§ï¼‰ ==== */
  const TYPES = {
    'ãƒ’ãƒ¬ç”·çˆµ':           { c:{rich:-2, adv:-2, tempo:-2, social:-2, texture:-2}, one:'é™ã‹ãªä¸»å½¹ã€‚ç„¡é§„ãªãä¸Šå“ã€èŠ¯ã¯å¼·ã„ã€‚', best:'æ›¸é“å®¶ãƒŸã‚¹ã‚¸', caution:'ã‚®ãƒ£ãƒ«ã‚«ãƒ«ãƒ“' },
    'ã‚¿ãƒ³éšŠé•·':           { c:{rich:-1, adv:+1, tempo:+2, social:+1, texture:+2}, one:'åˆå›³ã¨æ®µå–ã‚Šã§å ´ã‚’å›ã™ãƒ ãƒ¼ãƒ‰ç‰½å¼•ã€‚', best:'ãƒªãƒ–ãƒ­ãƒ¼ã‚¹ãƒœã‚¹', caution:'ã‚·ãƒ£ãƒˆãƒ¼ãƒ–ãƒªã‚¢ãƒ³å¥³ç‹' },
    'ã‚¤ãƒãƒœãƒãƒ':         { c:{rich:+1, adv:-1, tempo:-1, social:-1, texture:-1}, one:'é¢å€’è¦‹ã®è‰¯ã•ã¨å®‰å¿ƒæ„Ÿã€‚æ§ãˆã‚ã§ã‚‚é ¼ã‚Œã‚‹ã€‚', best:'ã‚„ã‚Šæ‰‹ã®å–¶æ¥­ãƒãƒ³ãƒãƒ©ãƒŸ', caution:'ã‚µãƒ¼ãƒ­ã‚¤ãƒ³ç‹' },
    'ãƒ©ãƒ³ãƒ—åšå£«':         { c:{rich:-1, adv:+2, tempo:+1, social: 0, texture:+1}, one:'å°ã•ãªå®Ÿé¨“ã§ä¼šè©±ã‚’åºƒã’ã‚‹è¦³å¯Ÿçœ¼ã€‚', best:'ã‚«ã‚¤ãƒãƒŸèˆå¦“ã¯ã‚“', caution:'ãƒªãƒ–ãƒ­ãƒ¼ã‚¹ãƒœã‚¹' },
    'ãƒªãƒ–ãƒ­ãƒ¼ã‚¹ãƒœã‚¹':     { c:{rich:+2, adv:-1, tempo: 0, social:+1, texture:-1}, one:'ã©ã£ã—ã‚Šæº€è¶³åº¦ã€‚é ¼ã‚Œã‚‹çµ±ç‡åŠ›ã€‚', best:'ã‚®ãƒ£ãƒ«ã‚«ãƒ«ãƒ“', caution:'ã‚«ã‚¤ãƒãƒŸèˆå¦“ã¯ã‚“' },
    'ã‚µãƒ¼ãƒ­ã‚¤ãƒ³ç‹':       { c:{rich:+2, adv:+1, tempo:+1, social:+2, texture: 0}, one:'è¯ã‚„ã‹ãªæ¼”å‡ºã§å ´ã‚’æ˜ã‚‹ãã™ã‚‹ç‹é“ã€‚', best:'ã‚·ãƒ£ãƒˆãƒ¼ãƒ–ãƒªã‚¢ãƒ³å¥³ç‹', caution:'æ›¸é“å®¶ãƒŸã‚¹ã‚¸' },
    'ç¾é£Ÿå®¶ã‚¶ãƒ–ãƒˆãƒ³':     { c:{rich:+2, adv:-2, tempo:-2, social:-1, texture:-1}, one:'ã—ã£ã¨ã‚Šæ¿ƒåšã€‚è¨€è‘‰ã‚‚æ‰€ä½œã‚‚ä¸å¯§ã€‚', best:'ã‚¿ãƒ³éšŠé•·', caution:'ã‚„ã‚Šæ‰‹ã®å–¶æ¥­ãƒãƒ³ãƒãƒ©ãƒŸ' },
    'ã‚®ãƒ£ãƒ«ã‚«ãƒ«ãƒ“':       { c:{rich:+2, adv:+2, tempo:+2, social:+2, texture: 0}, one:'ã”è¤’ç¾æ„Ÿã§å ´ã‚’çˆ†ä¸Šã’ã™ã‚‹ã‚¨ãƒ³ã‚¿ãƒ¡åŠ›ã€‚', best:'ã‚µãƒ¼ãƒ­ã‚¤ãƒ³ç‹', caution:'ãƒ©ãƒ³ãƒ—åšå£«' },
    'ã‚„ã‚Šæ‰‹ã®å–¶æ¥­ãƒãƒ³ãƒãƒ©ãƒŸ': { c:{rich: 0, adv:+1, tempo:+2, social:+1, texture:+1}, one:'ãƒ†ãƒ³ãƒè‰¯ãå®Ÿå‹™ã‚‚ä¼šè©±ã‚‚å›ã™åˆ‡æ›¿ä¸Šæ‰‹ã€‚', best:'ã‚¤ãƒãƒœãƒãƒ', caution:'ç¾é£Ÿå®¶ã‚¶ãƒ–ãƒˆãƒ³' },
    'ã‚«ã‚¤ãƒãƒŸèˆå¦“ã¯ã‚“':   { c:{rich:+1, adv: 0, tempo:+1, social: 0, texture:-1}, one:'è»½ã‚„ã‹ä¸Šå“ã€‚å ´ã®æ©‹æ¸¡ã—ãŒå¾—æ„ã€‚', best:'ãƒ©ãƒ³ãƒ—åšå£«', caution:'ã‚„ã‚Šæ‰‹ã®å–¶æ¥­ãƒãƒ³ãƒãƒ©ãƒŸ' },
    'æ›¸é“å®¶ãƒŸã‚¹ã‚¸':       { c:{rich:+1, adv:-2, tempo:-2, social:-2, texture:-2}, one:'ç¹Šç´°ãªç¾æ„è­˜ã€‚é™ã‹ã«æ·±ãå‘ãåˆã†ã€‚', best:'ãƒ’ãƒ¬ç”·çˆµ', caution:'ã‚¤ãƒãƒœãƒãƒ' },
    'ã‚·ãƒ£ãƒˆãƒ¼ãƒ–ãƒªã‚¢ãƒ³å¥³ç‹': { c:{rich:+1, adv:-1, tempo:-2, social:-1, texture:-2}, one:'é‡ã‚ˆã‚Šè³ªã®ä¸€ç‚¹é›†ä¸­ã€‚é™ã‹ãªæ ¼ä¸Šã€‚', best:'ç¾é£Ÿå®¶ã‚¶ãƒ–ãƒˆãƒ³', caution:'ãƒ’ãƒ¬ç”·çˆµ' },
  };

  /* ==== ã‚­ãƒ£ãƒ©ç”»åƒ ==== */
  const TYPE_IMAGE = {
    'ãƒ’ãƒ¬ç”·çˆµ':'hire.png',
    'ã‚¿ãƒ³éšŠé•·':'tan.png',
    'ã‚¤ãƒãƒœãƒãƒ':'ichibo.png',
    'ãƒ©ãƒ³ãƒ—åšå£«':'ranpu.png',
    'ãƒªãƒ–ãƒ­ãƒ¼ã‚¹ãƒœã‚¹':'riburo-su.png',
    'ã‚µãƒ¼ãƒ­ã‚¤ãƒ³ç‹':'sa-roin.png',
    'ç¾é£Ÿå®¶ã‚¶ãƒ–ãƒˆãƒ³':'zabuton.png',
    'ã‚®ãƒ£ãƒ«ã‚«ãƒ«ãƒ“':'karubi.png',
    'ã‚„ã‚Šæ‰‹ã®å–¶æ¥­ãƒãƒ³ãƒãƒ©ãƒŸ':'harami.png',
    'ã‚«ã‚¤ãƒãƒŸèˆå¦“ã¯ã‚“':'kainomi.png',
    'æ›¸é“å®¶ãƒŸã‚¹ã‚¸':'misuji.png',
    'ã‚·ãƒ£ãƒˆãƒ¼ãƒ–ãƒªã‚¢ãƒ³å¥³ç‹':'shato-.png',
  };

  /* ==== 20å•ï¼ˆè¦‹ã‚„ã™ãè¡¨ç¾ï¼‰ ==== */
  const Q = [
    {id:1,  axis:'rich',   head:'æœ€åˆã®ä¸€çš¿ã¯ï¼Ÿ',       text:'åŒã˜ä¾¡æ ¼ãªã‚‰ã©ã¡ã‚‰ã‚’é¸ã¶ï¼Ÿ', A:'èµ¤èº«ã§è»½ã', B:'ã‚³ã‚¯ã®ã‚ã‚‹ãƒªãƒƒãƒ'},
    {id:2,  axis:'rich',   head:'ãƒ¡ã‚¤ãƒ³ã®ä¸€çš¿',         text:'æº€è¶³åº¦ã‚’å„ªå…ˆã™ã‚‹ãªã‚‰',       A:'ãƒ’ãƒ¬ãƒ»ãƒ©ãƒ³ãƒ—ãªã©èµ¤èº«', B:'ãƒªãƒ–ãƒ­ãƒ¼ã‚¹ãƒ»ã‚µãƒ¼ãƒ­ã‚¤ãƒ³'},
    {id:3,  axis:'rich',   head:'è„‚ã®é‡ã®å¥½ã¿',         text:'å¥½ããªæ–¹å‘æ€§ã«è¿‘ã„ã®ã¯',     A:'è„‚æ§ãˆã‚ã§ã‚­ãƒ¬', B:'è„‚ã®æ—¨ã¿ã‚’ã—ã£ã‹ã‚Š'},
    {id:4,  axis:'rich',   head:'ãƒœãƒªãƒ¥ãƒ¼ãƒ æ„Ÿ',         text:'é‡ã¨é‡ã•ã®ãƒãƒ©ãƒ³ã‚¹ã¯',       A:'è»½ã‚ãŒå¥½ã', B:'é‡åšã§ã‚‚OK'},

    {id:5,  axis:'adv',    head:'ã‚ªãƒ¼ãƒ€ãƒ¼æ–¹é‡',         text:'ã¯ã˜ã‚ã¦ã®ãŠåº—ã§',           A:'ç‹é“ãƒ¡ãƒ‹ãƒ¥ãƒ¼ä¸­å¿ƒ', B:'é™å®šãƒ»å‰µä½œã‚‚æ”»ã‚ã‚‹'},
    {id:6,  axis:'adv',    head:'æ–°ãƒ¡ãƒ‹ãƒ¥ãƒ¼',           text:'æœªçŸ¥ã®ä¸€çš¿ãŒã‚ã£ãŸã‚‰',       A:'æ§˜å­è¦‹', B:'ã¾ãšè©¦ã™'},
    {id:7,  axis:'adv',    head:'å‘³ä»˜ã‘ã®é¸ã³æ–¹',       text:'åŸºæœ¬ã¯',                     A:'å®šç•ªã®å¡©ï¼ç‰¹è£½ã‚½ãƒ¼ã‚¹', B:'æ—¬ã®ã‚½ãƒ¼ã‚¹ã‚„ã‚¹ãƒ‘ã‚¤ã‚¹æ­“è¿'},
    {id:8,  axis:'adv',    head:'ç„¼ãæ–¹ã‚«ã‚¹ã‚¿ãƒ ',       text:'è‡ªåˆ†ã§èª¿æ•´ã™ã‚‹ã®ã¯',         A:'ã‚ã¾ã‚Šã—ãªã„', B:'ç©æ¥µçš„ã«ã‚„ã‚‹'},

    {id:9,  axis:'tempo',  head:'é£Ÿäº‹ã®ãƒ†ãƒ³ãƒ',         text:'ç†æƒ³ã®é€²è¡Œã¯',               A:'ä¸€çš¿ãšã¤ã‚†ã£ãã‚Š', B:'ã‚µã‚¯ã‚µã‚¯è»½å¿«ã«'},
    {id:10, axis:'tempo',  head:'å¸­æ›¿ãˆã®é »åº¦',         text:'ä¼šã®ç››ã‚Šä¸Šã’ã¨ã—ã¦',         A:'ã»ã¨ã‚“ã©ã—ãªã„', B:'ãƒ†ãƒ³ãƒã‚ˆãè¡Œã†'},
    {id:11, axis:'tempo',  head:'BGMã¨é›°å›²æ°—',          text:'å¿ƒåœ°ã‚ˆã„ã®ã¯',               A:'è½ã¡ç€ã„ãŸé›°å›²æ°—', B:'è³‘ã‚„ã‹ãªé›°å›²æ°—'},
    {id:12, axis:'tempo',  head:'å†™çœŸãƒ»å‹•ç”»ã®æ’®å½±',     text:'é€²è¡Œã®ä¸­ã§',                 A:'æœ€å°é™ã§OK', B:'ãƒ†ãƒ³ãƒè‰¯ãæ’®ã£ã¦å…±æœ‰'},

    {id:13, axis:'social', head:'äººæ•°ã®å¥½ã¿',           text:'å±…å¿ƒåœ°ãŒè‰¯ã„ã®ã¯',           A:'2ã€œ3äººã§ã˜ã£ãã‚Š', B:'å¤§äººæ•°ã§ãƒ¯ã‚¤ãƒ¯ã‚¤'},
    {id:14, axis:'social', head:'ä¹¾æ¯å¾Œã®å‹•ã',         text:'æœ€åˆã«ã‚„ã‚ŠãŒã¡ãªã®ã¯',       A:'å‘ã‹ã„ã®äººã¨æ·±ãè©±ã™', B:'ãƒ†ãƒ¼ãƒ–ãƒ«å…¨å“¡ã«å£°ã‚’ã‹ã‘ã‚‹'},
    {id:15, axis:'social', head:'è¨˜å¿µæ’®å½±',             text:'å†™çœŸã‚’æ’®ã‚‹ãªã‚‰',             A:'å¿…è¦ãªäººã ã‘ã§', B:'å…¨å“¡ã§æ’®ã‚ŠãŸã„'},
    {id:16, axis:'social', head:'å¸­ã®é¸ã³æ–¹',           text:'è½ã¡ç€ãã®ã¯',               A:'éš…ã®å¸­ã§è½ã¡ç€ã', B:'ä¸­å¤®å¯„ã‚Šã§äº¤æµã—ã‚„ã™ã'},

    {id:17, axis:'texture',head:'é£Ÿæ„Ÿã®å¥½ã¿',           text:'ã©ã¡ã‚‰ãŒã‚ˆã‚Šå¥½ã¿ï¼Ÿ',         A:'å£ã©ã‘ãªã‚ã‚‰ã‹', B:'æ­¯ã”ãŸãˆã—ã£ã‹ã‚Š'},
    {id:18, axis:'texture',head:'ã‚«ãƒƒãƒˆåš',             text:'è‚‰ã®åšã¿ã«é–¢ã—ã¦',           A:'è–„ã‚ã§è»½ã', B:'åšã‚ã§å™›ã¿ãŸã„'},
    {id:19, axis:'texture',head:'ç„¼ãåŠ æ¸›',             text:'åŸºæœ¬ã®ç«å…¥ã‚Œã¯',             A:'ãƒ¬ã‚¢å¯„ã‚Šã§æŸ”ã‚‰ã‹ã', B:'ãƒŸãƒ‡ã‚£ã‚¢ãƒ ä»¥ä¸Šã§é£Ÿã¹å¿œãˆ'},
    {id:20, axis:'texture',head:'èª¿ç†ã®æ–¹å‘æ€§',         text:'ä»•ä¸ŠãŒã‚Šã®ãƒ‹ãƒ¥ã‚¢ãƒ³ã‚¹',       A:'ä½æ¸©ã§ã—ã£ã¨ã‚Š', B:'ç‚­ç«é¦™ã§å™›ã¿ç· ã‚ã‚‹'},
  ];

  /* ==== çŠ¶æ…‹ ==== */
  const PAGE_SIZE = 5, TOTAL_PAGES = Q.length / PAGE_SIZE; // 4
  let page = 0; // 0..3
  let answers = []; // {id, value(-2..2)}
  let focusId = null;

  const $ = (id)=>document.getElementById(id);
  $('y').textContent = new Date().getFullYear();

  $('prevPage').onclick = ()=>{ if(page>0){ page--; renderPage(); } };
  $('nextPage').onclick = ()=>{ if(canNextPage()){ page++; renderPage(); } };

  window.addEventListener('keydown',(e)=>{
    if(!/^[1-5]$/.test(e.key)) return;
    if(focusId==null) return;
    chooseAnswer(focusId, (+e.key)-3, {autoAdvance:true}); // 1â†’-2 ... 5â†’+2
  });

  renderPage();

  function renderPage(){
    // dots
    for(let i=1;i<=4;i++) $('dot'+i).classList.toggle('active', i===page+1);

    $('bar').style.width = (answeredCount()/Q.length*100)+'%';
    $('answered').textContent = answeredCount();
    $('remainTxt').textContent = `æ®‹ã‚Š ${Q.length - answeredCount()} å•`;

    const grid = $('qGrid'); grid.innerHTML='';
    const slice = Q.slice(page*PAGE_SIZE, page*PAGE_SIZE+PAGE_SIZE);
    const firstUn = slice.find(q => findAnswer(q.id)==null);
    focusId = firstUn ? firstUn.id : slice[0].id;

    slice.forEach((q,i)=>{
      grid.appendChild(renderCard(q, i));
    });

    $('prevPage').disabled = (page===0);
    $('nextPage').disabled = !canNextPage();
    // æœ€åˆã®ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã¸è»½ãã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
    setTimeout(()=> scrollToCard(focusId), 10);
  }

  function renderCard(q, idx){
    const card = document.createElement('div');
    card.className = 'qcard' + (q.id===focusId?' focus':'');
    card.dataset.qid = q.id;

    const ans = findAnswer(q.id)?.value;
    const labels = [
      {v:-2, t:'Aã«ã¨ã¦ã‚‚è¿‘ã„'},
      {v:-1, t:'Aã«è¿‘ã„'},
      {v: 0, t:'ä¸­é–“'},
      {v:+1, t:'Bã«è¿‘ã„'},
      {v:+2, t:'Bã«ã¨ã¦ã‚‚è¿‘ã„'},
    ];
    const cells = labels.map(({v,t},i)=>`
      <div class="cell" data-val="${v}" data-sel="${ans===v?1:0}" role="button" aria-label="${t}">
        <strong>${i+1}</strong><small>${t}</small>
      </div>
    `).join('');

    card.innerHTML = `
      <div class="qnum">Q${q.id} / 20</div>
      <p class="qhead">${q.head}</p>
      <p class="qtext">${q.text}</p>
      <div class="anchors">
        <div class="ab">
          <span class="A">${q.A}</span>
          <span class="B">${q.B}</span>
        </div>
        <span class="chip">ã‚¿ãƒƒãƒ— or ã‚­ãƒ¼ <b>1ã€œ5</b></span>
      </div>
      <div class="scale">${cells}</div>
    `;

    card.addEventListener('click',()=> {
      focusId = q.id;
      document.querySelectorAll('.qcard').forEach(c=>c.classList.toggle('focus', c.dataset.qid==q.id));
    });

    card.querySelectorAll('.cell').forEach(cell=>{
      cell.addEventListener('click', ()=>{
        const v = Number(cell.dataset.val);
        chooseAnswer(q.id, v, {autoAdvance:true});
      });
    });

    return card;
  }

  function chooseAnswer(qid, v, {autoAdvance}={}){
    const i = answers.findIndex(a=>a.id===qid);
    if(i>=0) answers[i].value = v; else answers.push({id:qid, value:v});

    const card = document.querySelector(`.qcard[data-qid="${qid}"]`);
    if(card){
      card.querySelectorAll('.cell').forEach((c, idx)=>{
        const vv = [-2,-1,0,1,2][idx]; c.dataset.sel = (vv===v)?'1':'0';
      });
    }

    $('answered').textContent = answeredCount();
    $('bar').style.width = (answeredCount()/Q.length*100)+'%';
    $('remainTxt').textContent = `æ®‹ã‚Š ${Q.length - answeredCount()} å•`;
    $('nextPage').disabled = !canNextPage();

    if(autoAdvance){
      const slice = Q.slice(page*PAGE_SIZE, page*PAGE_SIZE+PAGE_SIZE);
      const nextUn = slice.find(q => findAnswer(q.id)==null);
      if(nextUn){
        focusId = nextUn.id;
        setFocusVisual(focusId);
        scrollToCard(focusId);
      }else{
        setTimeout(()=>{
          if(page < TOTAL_PAGES-1){ page++; renderPage(); }
          else{ showResult(); }
        }, 180);
      }
    }
  }

  function setFocusVisual(fid){
    document.querySelectorAll('.qcard').forEach(c=>c.classList.toggle('focus', c.dataset.qid==fid));
  }
  function scrollToCard(fid){
    const el = document.querySelector(`.qcard[data-qid="${fid}"]`);
    if(!el) return;
    const top = el.getBoundingClientRect().top + window.scrollY - 110;
    window.scrollTo({top, behavior:'smooth'});
  }

  function answeredCount(){ return answers.length; }
  function findAnswer(id){ return answers.find(a=>a.id===id) || null; }
  function canNextPage(){
    const slice = Q.slice(page*PAGE_SIZE, page*PAGE_SIZE+PAGE_SIZE);
    return slice.every(q => findAnswer(q.id));
  }

  /* ==== åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯ï¼ˆæœ€å°äºŒä¹—ï¼‰ ==== */
  function diagnose(ans){
    const sum = Object.fromEntries(AXES.map(a=>[a,0]));
    const cnt = Object.fromEntries(AXES.map(a=>[a,0]));
    for(const a of ans){
      const q = Q.find(x=>x.id===a.id); if(!q) continue;
      sum[q.axis]+=a.value; cnt[q.axis]+=1;
    }
    const vec = {}; for(const ax of AXES){ vec[ax] = cnt[ax] ? (sum[ax]/cnt[ax]) : 0; }

    let best=null, bestDist=Infinity;
    for(const [name, t] of Object.entries(TYPES)){
      const d = AXES.reduce((s,ax)=> s + Math.pow(vec[ax]-t.c[ax],2), 0);
      if(d<bestDist || (d===bestDist && name.localeCompare(best)<0)){ bestDist=d; best=name; }
    }
    const t = TYPES[best];
    return { name:best, vec, one:t.one, bestMate:t.best, caution:t.caution };
  }

  function tagify(vec){
    const t=[];
    t.push( vec.rich<=-1 ? 'èµ¤èº«å¯„ã‚Š' : vec.rich>=1 ? 'ã‚³ã‚¯å¯„ã‚Š' : 'ä¸­åº¸');
    t.push( vec.adv <=-1 ? 'ç‹é“æ´¾'  : vec.adv >=1 ? 'å†’é™ºæ´¾'  : 'æ™‚ã¨å ´åˆ');
    t.push( vec.tempo<=-1 ? 'ã—ã£ã¨ã‚Š' : vec.tempo>=1 ? 'ã«ãã‚„ã‹' : 'ãƒãƒ©ãƒ³ã‚¹');
    t.push( vec.social<=-1 ? 'å°‘äººæ•°å¥½ã' : vec.social>=1 ? 'å¤§äººæ•°å¥½ã' : 'ã©ã¡ã‚‰ã§ã‚‚');
    t.push( vec.texture<=-1 ? 'å£ã©ã‘æ´¾' : vec.texture>=1 ? 'å™›ã¿ã”ãŸãˆæ´¾' : 'ã©ã¡ã‚‰ã‚‚OK');
    return t;
  }

  function showResult(){
    const r = diagnose(answers);
    document.getElementById('quizCard').hidden = true;
    document.getElementById('resultCard').hidden = false;

    $('rType').textContent = r.name;
    $('rOne').textContent  = r.one;
    $('bestMate').textContent = r.bestMate;
    $('caution').textContent  = r.caution;

    const img = TYPE_IMAGE[r.name] || '';
    const rImg = $('rImg'); rImg.src = img; rImg.alt = r.name;

    const holder = $('rTags'); holder.innerHTML='';
    tagify(r.vec).forEach(s=>{
      const span=document.createElement('span'); span.className='tag'; span.textContent=s; holder.appendChild(span);
    });

    $('retryBtn').onclick = ()=>{
      page=0; answers=[]; renderPage();
      $('resultCard').hidden = true; $('quizCard').hidden = false;
      window.scrollTo({top:0,behavior:'smooth'});
    };
    $('saveBtn').onclick = ()=>{
      const payload = { type:r.name, one:r.one, best:r.bestMate, caution:r.caution, vector:r.vec, answers, generatedAt:new Date().toISOString() };
      const blob=new Blob([JSON.stringify(payload,null,2)],{type:'application/json'});
      const url=URL.createObjectURL(blob);
      const a=document.createElement('a'); a.href=url; a.download=`MeatBTI_${r.name}.json`; a.click(); URL.revokeObjectURL(url);
    };

    window.scrollTo({top:0,behavior:'smooth'});
  }
</script>
</body>
</html>
