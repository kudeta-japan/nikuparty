<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Meat BTI è¨ºæ–­ï½œè‡ªå·±å®Œçµç‰ˆ</title>
<meta name="theme-color" content="#0b0e17">
<style>
:root{
  --bg:#0b0e17; --panel:#121828; --panel2:#0f1524; --ink:#e9eef8; --muted:#98a2b3; --line:#203054;
  --acc:#7aa2ff; --mid:#facc15; --good:#22c55e; --warn:#ff8a65;
}
*{box-sizing:border-box}
body{margin:0;background:radial-gradient(1200px 700px at 50% -10%,#111a30 0%,#0b0e17 60%);color:var(--ink);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,"Hiragino Kaku Gothic ProN","Meiryo",sans-serif}
a{color:inherit;text-decoration:none}
.topbar{position:sticky;top:0;z-index:10;background:rgba(11,14,23,.85);backdrop-filter:blur(6px);
  border-bottom:1px solid var(--line)}
.container{width:min(980px,94vw);margin:0 auto;padding:14px 0 80px}
.brand{display:flex;align-items:center;gap:10px;font-weight:900;padding:8px 0}
.badge{width:28px;height:28px;border-radius:8px;display:grid;place-items:center;background:conic-gradient(from 140deg,#ffd966,#ff6b4a);color:#0e0b07}
.ghost{margin-left:auto;padding:8px 12px;border:1px solid var(--line);border-radius:10px;color:var(--muted)}
.panel{background:linear-gradient(180deg,var(--panel),var(--panel2));border:1px solid var(--line);border-radius:16px}
.p16{padding:16px}
.h1{font-size:clamp(22px,4.6vw,34px);font-weight:900;margin:0 0 8px}
.lead{color:var(--muted);margin:0 0 14px}
.btns{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
.btn{appearance:none;border:1px solid var(--line);background:#141b31;color:var(--ink);padding:12px 16px;border-radius:12px;font-weight:800;cursor:pointer}
.btn.primary{background:linear-gradient(180deg,#ffd166,#f9c23c);color:#332100;border:none}
.btn.slim{padding:8px 12px}
.grid12{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
@media(min-width:800px){.grid12{grid-template-columns:repeat(4,1fr)}}
.card{background:#0f1527;border:1px solid var(--line);border-radius:14px;padding:12px;display:flex;gap:10px}
.card img{width:60px;height:60px;object-fit:contain;border-radius:12px;background:#0c1325;border:1px solid var(--line)}
.card b{display:block}
.small{font-size:12px;color:#a9b5cc}

/* hero */
.hero-wide{margin:8px 0 14px;border-radius:18px;overflow:hidden;border:1px solid var(--line)}
.hero-wide img{display:block;width:100%;height:auto;object-fit:cover}

/* Quiz */
.step{display:none}
.step.active{display:block}
.progress{height:8px;background:#0e1426;border:1px solid var(--line);border-radius:999px;overflow:hidden}
.progress .fill{height:100%;background:linear-gradient(90deg,#66d2ff,#7aa2ff,#9b87f5);width:0%}
.qgrid{display:grid;grid-template-columns:1fr;gap:12px}
@media(min-width:860px){.qgrid{grid-template-columns:1fr 1fr}}
.qbox{background:#0f1527;border:1px solid var(--line);border-radius:14px;padding:14px}
.qtitle{font-weight:900;margin:0 0 10px}
.scale{display:flex;gap:8px;flex-wrap:nowrap}
.opt{flex:1 1 0;min-width:0;display:grid;place-items:center;padding:10px;border-radius:12px;
  border:1px solid #2a3a64;background:#101938;cursor:pointer;user-select:none}
.opt.mid{border-color:#5b4b12;background:#1b1a0b;color:#ffe28a}
.opt.sel{outline:2px solid var(--acc);background:#142245}
.opt.mid.sel{outline:2px solid var(--mid);background:#2a2209}
.kbd{font-size:11px;color:#93a3c8;margin-left:8px}

/* Result */
.row{display:grid;grid-template-columns:1fr;gap:14px}
@media(min-width:880px){.row{grid-template-columns:1.2fr .8fr}}
.hero{display:grid;grid-template-columns:auto 1fr;gap:16px;align-items:center}
.hero img{width:120px;height:120px;border-radius:20px;background:#0d1324;object-fit:contain;border:1px solid var(--line)}
.badge2{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:999px;border:1px solid var(--line);background:#151c32;color:#cbd5e1;font-weight:700}
.type-desc{margin:6px 0 8px;line-height:1.9;color:#cfd6e7}
.bars{display:grid;gap:10px}
.bar{display:grid;grid-template-columns:140px 1fr;gap:10px;align-items:center}
.track{height:10px;background:#0e1426;border:1px solid var(--line);border-radius:999px;overflow:hidden}
.fill{height:100%;background:linear-gradient(90deg,#66d2ff,#7aa2ff,#9b87f5);width:0%}
.pair{display:flex;gap:12px;align-items:center}
.pair img{width:72px;height:72px;object-fit:contain;border-radius:14px;border:1px solid var(--line);background:#0d1324}
.warn{color:#ffb4a2}
footer{border-top:1px solid var(--line);color:var(--muted);text-align:center;padding:22px 0;margin-top:28px}
</style>
</head>
<body>
<div class="topbar">
  <div class="container" style="display:flex;align-items:center;gap:12px">
    <div class="brand"><div class="badge">ğŸ¥©</div><div>Meat BTI</div></div>
    <a class="ghost" href="../">â† LPã¸æˆ»ã‚‹</a>
  </div>
</div>

<div class="container">
  <!-- hero -->
  <figure class="hero-wide"><img src="hero_meatbti.png" alt="Meat BTI"></figure>

  <!-- STEP 0: ã‚¿ã‚¤ãƒ—ç´¹ä»‹ -->
  <section id="step0" class="step active panel p16">
    <h1 class="h1">ã‚ãªãŸã¯ã©ã®â€œéƒ¨ä½ã‚¿ã‚¤ãƒ—â€ï¼Ÿ</h1>
    <p class="lead">12ã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‹ã‚‰ã€ä¸€ç•ªè¿‘ã„ã‚¿ã‚¤ãƒ—ã¨ç›¸æ€§No.1ã‚’åˆ¤å®šã—ã¾ã™ï¼ˆ20å•ãƒ»æ‰€è¦1ã€œ2åˆ†ï¼‰ã€‚</p>
    <div id="typeGrid" class="grid12"></div>
    <div class="btns">
      <button class="btn primary" id="startBtn">è¨ºæ–­ã‚’ã¯ã˜ã‚ã‚‹</button>
    </div>
  </section>

  <!-- STEP 1: ã‚¯ã‚¤ã‚ºï¼ˆ5å•Ã—4ãƒšãƒ¼ã‚¸ï¼‰ -->
  <section id="step1" class="step panel p16">
    <div style="display:flex;align-items:center;gap:10px;margin-bottom:10px">
      <b id="pp">Q1â€“5 / 20</b>
      <div class="progress" style="flex:1"><div id="progFill" class="fill" style="width:0%"></div></div>
      <span class="kbd">ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆï¼š1ã€œ5</span>
    </div>
    <div id="qgrid" class="qgrid"></div>
    <div class="btns" style="justify-content:space-between">
      <button class="btn slim" id="prevBtn">â† å‰ã®5å•</button>
      <button class="btn primary" id="nextBtn">æ¬¡ã®5å• â†’</button>
    </div>
  </section>

  <!-- STEP 2: çµæœ -->
  <section id="step2" class="step">
    <div class="row">
      <section class="panel p16">
        <div class="hero">
          <img id="heroImg" alt="">
          <div>
            <div class="badge2">ã‚ãªãŸã®ã‚¿ã‚¤ãƒ—</div>
            <h2 id="typeName" class="h1" style="margin-top:6px"></h2>
            <p id="typeCatch" class="lead" style="margin-bottom:6px"></p>
            <p id="typeDesc" class="type-desc"></p>
            <div id="tips" class="btns" style="margin-top:0"></div>
            <div class="btns">
              <button class="btn primary" id="againBtn">ã‚‚ã†ä¸€åº¦è¨ºæ–­</button>
              <a class="btn" href="../">LPã¸æˆ»ã‚‹</a>
            </div>
          </div>
        </div>
        <hr style="border:none;border-top:1px solid var(--line);margin:16px 0">
        <h3>ã‚ãªãŸã®å‘³è¦šãƒ»ã‚¹ã‚¿ã‚¤ãƒ«å‚¾å‘</h3>
        <div id="bars" class="bars"></div>
        <p class="small">å°ºåº¦ï¼š0ï¼ˆå·¦å¯„ã‚Šï¼‰ã€œ 100ï¼ˆå³å¯„ã‚Šï¼‰ã€‚<br>
          é¢¨å‘³Aï¼šèµ¤èº«å¯„ã‚Š â†”ï¸ æ¿ƒåšå¯„ã‚Šï¼é‡Bï¼šè»½ã‚ â†”ï¸ ãƒœãƒªãƒ¥ãƒ¼ãƒ ï¼ãƒ†ãƒ³ãƒCï¼šé™ã‹ â†”ï¸ ã«ãã‚„ã‹ï¼æ¼”å‡ºDï¼šç´ æœ´ â†”ï¸ æ˜ ãˆã€‚</p>
      </section>

      <aside class="panel p16">
        <h3>ç›¸æ€§ No.1</h3>
        <div class="pair">
          <img id="pairImg" alt="">
          <div>
            <b id="pairName">-</b>
            <div id="pairWhy" class="small" style="margin-top:4px">-</div>
          </div>
        </div>
        <hr style="border:none;border-top:1px solid var(--line);margin:16px 0">
        <h3>è¿‘ã„ã‚¿ã‚¤ãƒ—ï¼ˆæ¬¡ç‚¹ï¼‰</h3>
        <div class="pair">
          <img id="secondImg" alt="">
          <div>
            <b id="secondName">-</b>
            <div id="secondWhy" class="small" style="margin-top:4px">å‘³è¦šãƒ»ã‚¹ã‚¿ã‚¤ãƒ«ãŒè¿‘ã„â€œä¼¼ã¦ã‚‹ç›¸æ‰‹â€ã€‚</div>
          </div>
        </div>
      </aside>
    </div>
  </section>

  <!-- ã‚¨ãƒ©ãƒ¼ -->
  <section id="err" class="panel p16" style="display:none">
    <b class="warn">è¨ºæ–­ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</b>
    <p class="small">ã“ã®ç”»é¢ãŒå‡ºã‚‹å ´åˆã¯ã€ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ã‚„ã‚Šç›´ã—ã¦ãã ã•ã„ã€‚</p>
    <div class="btns"><button class="btn primary" onclick="go(0)">è¨ºæ–­ã‚’ã¯ã˜ã‚ã‚‹</button></div>
  </section>
</div>

<footer>Â© 2025 Meat BTI</footer>

<script>
/* ====== ãƒ‡ãƒ¼ã‚¿å®šç¾© ====== */
const IMGS = {
  "ãƒ’ãƒ¬ç”·çˆµ":"hire.png","ã‚¿ãƒ³éšŠé•·":"tan.png","ã‚¤ãƒãƒœãƒãƒ":"ichibo.png","ãƒ©ãƒ³ãƒ—åšå£«":"ranpu.png",
  "ãƒªãƒ–ãƒ­ãƒ¼ã‚¹ãƒœã‚¹":"riburo-su.png","ã‚µãƒ¼ãƒ­ã‚¤ãƒ³ç‹":"sa-roin.png","ç¾é£Ÿå®¶ã‚¶ãƒ–ãƒˆãƒ³":"zabuton.png",
  "ã‚®ãƒ£ãƒ«ã‚«ãƒ«ãƒ“":"karubi.png","ã‚„ã‚Šæ‰‹ã®å–¶æ¥­ãƒãƒ³ãƒãƒ©ãƒŸ":"harami.png","ã‚«ã‚¤ãƒãƒŸèˆå¦“ã¯ã‚“":"kainomi.png",
  "æ›¸é“å®¶ãƒŸã‚¹ã‚¸":"misuji.png","ã‚·ãƒ£ãƒˆãƒ¼ãƒ–ãƒªã‚¢ãƒ³å¥³ç‹":"shato-.png"
};

const TYPES = {
  "ãƒ’ãƒ¬ç”·çˆµ":{v:[-1.5,-1.0,-0.5,-0.5], one:"é™ã‹ãªä¸»å½¹ã®èµ¤èº«æ´¾",
    catch:"ç„¡é§„ãªãä¸Šå“ã€èŠ¯ãŒå¼·ã„èµ¤èº«æ´¾ã€‚",
    desc:"ç„¡é§„ã‚’ããè½ã¨ã—ãŸä¸Šå“ã•ã‚’æ„›ã™ã‚‹èµ¤èº«æ´¾ã€‚é‡ã‚ˆã‚Šè³ªã€å‘³ã¤ã‘ã¯ã¾ãšå¡©ã§ç´ æã®èŠ¯ã‚’ç¢ºã‹ã‚ã‚‹æ…é‡æ´¾ã§ã™ã€‚å ´ã§ã¯ç©ã‚„ã‹ã§èª å®Ÿã€ç›¸æ‰‹ã®ãƒšãƒ¼ã‚¹ã«å¯„ã‚Šæ·»ã„ãªãŒã‚‰ä¼šè©±ã‚’æ•´ãˆã‚‹ã®ãŒå¾—æ„ã€‚æ®µå–ã‚Šã‚‚ä¸å¯§ã§ã€ä¼šé£Ÿã‚„ãƒ‡ãƒ¼ãƒˆã‚’è½ã¡ç€ã„ã¦é€²è¡Œã€‚æ´¾æ‰‹ã•ã¯æ§ãˆã‚ã‚†ãˆæ˜ ãˆé‡è¦–ã®äººã«ã¯åœ°å‘³ã«æ˜ ã‚‹ã“ã¨ã‚‚ã€‚é‡ããªã‚Šéããªã„ã‚ˆã†ãƒãƒ©ãƒ³ã‚¹ã‚ˆãã€çµ‚ç›¤ã¯è»½ã‚ã«ã¾ã¨ã‚ã‚‹ã®ãŒå¥½ç›¸æ€§ã€‚",
    tips:["æœ€åˆã¯â€œåç‰©ã®å¡©â€ã§ä¼šè©±ã‚’æ•´ãˆã‚‹","ç›¸æ‰‹ã®å¥½ã¿ã‚’1ã¤æ‹¾ã£ã¦æ¬¡ã®ä¸€çš¿ã«åæ˜ ","ä¹¾æ¯ã¯ãƒã‚¤ãƒœãƒ¼ãƒ«/ã‚¹ãƒ‘ãƒ¼ã‚¯ãƒªãƒ³ã‚°"]},
  "ã‚¿ãƒ³éšŠé•·":{v:[-1.0,-0.5,0.6,-0.2], one:"å ´ã‚’ã»ãã™ãƒ ãƒ¼ãƒ‰ãƒ¡ãƒ¼ã‚«ãƒ¼",
    catch:"ç©ºæ°—ã‚’ã»ãã™åˆ‡ã‚Šè¾¼ã¿éšŠé•·ã€‚",
    desc:"å ´ã‚’ã»ãã™ãƒ ãƒ¼ãƒ‰ãƒ¡ãƒ¼ã‚«ãƒ¼ã€‚ä¹¾æ¯ã®éŸ³é ­ã‚„æœ€åˆã®æ³¨æ–‡ã‚’ãƒ†ã‚­ãƒ‘ã‚­æ±ºã‚ã€ã‚¿ãƒ³å¡©ã‹ã‚‰èµ¤èº«ã¸ã¨ãƒ†ãƒ³ãƒã‚ˆãæµã‚Œã‚’ä½œã‚Šã¾ã™ã€‚å°çš¿ã‚·ã‚§ã‚¢ã‚„å†™çœŸå…±æœ‰ãªã©â€œã¿ã‚“ãªãŒå…¥ã‚Šã‚„ã™ã„â€ä»•æ›ã‘ãŒå¾—æ„ã§ã€åˆå¯¾é¢ã®ç©ºæ°—ã‚‚æ˜ã‚‹ãã€‚åé¢ã€æ·±ã„å‘³ã‚ã„ã‚„ä½™éŸ»ã‚’é‡è¦–ã™ã‚‹ç›¸æ‰‹ã«ã¯æµ…ãè¦‹ãˆãŒã¡ã€‚å¾ŒåŠã¯ä¸€çš¿ã‚’ã˜ã£ãã‚Šå‘³ã‚ã†æ™‚é–“ã‚’æŒŸã‚€ã¨ã€è»½ã‚„ã‹ã•ã¨æº€è¶³æ„Ÿã®ãƒãƒ©ãƒ³ã‚¹ãŒæ•´ã„ã¾ã™ã€‚",
    tips:["â€œã‚¿ãƒ³å¡©â†’èµ¤èº«â€ã®é»„é‡‘ãƒ«ãƒ¼ãƒˆ","å°çš¿ã‚·ã‚§ã‚¢ã§ä¼šè©±ã‚’å›ã™","ä¸€è¨€ã‚³ãƒ¡ãƒ³ãƒˆã§ç››ã‚Šä¸Šã’"]},
  "ã‚¤ãƒãƒœãƒãƒ":{v:[-0.5,-0.2,0.0,-0.2], one:"é€šå¥½ã¿ã®èª¿å’Œå½¹",
    catch:"é€šå¥½ã¿ã®èª¿å’Œå½¹ã€‚",
    desc:"èª¿å’Œé‡è¦–ã®å®‰å¿ƒæ‹…å½“ã€‚è„‚ã¯æ§ãˆã‚ã€èµ¤èº«ã®æ—¨ã¿ã‚’ä¸å¯§ã«å‘³ã‚ã†ã‚¹ã‚¿ã‚¤ãƒ«ã§ã€æ¯”è¼ƒé£Ÿã¹ã‚„åŠåˆ†ã“ãªã©â€œåˆã‚ã›æŠ€â€ãŒä¸Šæ‰‹ã€‚ç›¸æ‰‹ã®å¥½ã¿ã‚’ç´ æ—©ãæ‹¾ã£ã¦æ³¨æ–‡ã«åæ˜ ã—ã€ãƒšãƒ¼ã‚¹é…åˆ†ã‚‚ç©ã‚„ã‹ã€‚ç· ã‚ã¯è»½ã‚ã§ä½™ç™½ã‚’æ®‹ã™ã®ãŒæŒã¡å‘³ã§ã™ã€‚æ±ºæ–­ãŒã‚†ã£ãã‚Šã§ä¸»å½¹æ„ŸãŒå¼±ã„å ´é¢ã‚‚ã‚ã‚‹ãŸã‚ã€è¦‹ã›å ´ã®ä¸€çš¿ã‚’ã©ã“ã‹ã§ç”¨æ„ã™ã‚‹ã¨å…¨ä½“ãŒç· ã¾ã‚Šã¾ã™ã€‚",
    tips:["â€œæ¯”è¼ƒé£Ÿã¹â€ã§ä¼šè©±ã‚’ä½œã‚‹","ç«å…¥ã‚Œã¯ç›¸æ‰‹ã«å¯„ã‚Šæ·»ã†","ç· ã‚ã¯è»½ã‚ã§ä½™ç™½ã‚’æ®‹ã™"]},
  "ãƒ©ãƒ³ãƒ—åšå£«":{v:[-0.8,-0.5,0.0,0.2], one:"å°ã•ãªå†’é™ºå®¶",
    catch:"å®šç•ªã‚’æ›´æ–°ã™ã‚‹å·¥å¤«å¥½ãã€‚",
    desc:"å®šç•ªã‚’å°ã•ãæ›´æ–°ã™ã‚‹â€œå®Ÿé¨“å¥½ãâ€ã€‚å°‘é‡å¤šçš¿ã§å¤‰åŒ–ã‚’ã¤ãã‚Šã€ç„¼ãã‚„ç«å…¥ã‚Œã‚’è¦³å¯Ÿã—ã¦è©±é¡Œã«å¤‰ãˆã‚‹ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–æ´¾ã§ã™ã€‚é‡éããªã„èµ¤èº«ã‚’åŸºèª¿ã«ã€å‰µä½œç³»ã‚’ä¸€çš¿å·®ã—è¾¼ã‚€ã‚»ãƒ³ã‚¹ãŒå…‰ã‚‹ã€‚ãƒ†ãƒ³ãƒã¯è»½ã‚„ã‹ã§ã€ä¼šè©±ã®ã‚¹ã‚¤ãƒƒãƒã‚’å¢—ã‚„ã™ã®ãŒå¾—æ„ã€‚ä¿å®ˆçš„ãªç›¸æ‰‹ã«ã¯å¿™ã—ãªãæ˜ ã‚‹ã“ã¨ã‚‚ã‚ã‚‹ãŸã‚ã€é€”ä¸­ã«â€œè½ã¡ç€ãä¸€çš¿â€ã‚’ç½®ãã¨å®‰å¿ƒæ„ŸãŒå¢—ã—ã¾ã™ã€‚",
    tips:["â€œå°‘é‡Ã—å¤šçš¿â€ã§ãƒŸãƒ‹å®Ÿé¨“","å‰µä½œç³»ã‚’ä¸€çš¿ã¾ãœã‚‹","ç„¼ãæ‹…å½“ã§è¦³å¯Ÿï¼†è©±é¡Œ"]},
  "ãƒªãƒ–ãƒ­ãƒ¼ã‚¹ãƒœã‚¹":{v:[0.8,0.6,0.2,0.2], one:"å®‰å¿ƒæ„Ÿã®ãƒªãƒ¼ãƒ€ãƒ¼",
    catch:"ç‹é“ãƒªãƒƒãƒã§æº€è¶³åº¦é‡è¦–ã€‚",
    desc:"ç‹é“ã§æº€è¶³åº¦ã‚’ç´„æŸã™ã‚‹é ¼ã‚Œã‚‹ãƒªãƒ¼ãƒ€ãƒ¼ã€‚åç‰©ã‹ã‚‰åç‰©ã¸ã¨æ®µå–ã‚Šè‰¯ãé€²ã‚ã€ä¼šè¨ˆã‚„å¸­æ›¿ãˆã‚‚ãã£ã¡ã‚Šã€‚æ¿ƒåšã•ã¨é‡æ„Ÿã‚’ãƒãƒ©ãƒ³ã‚¹ã‚ˆãé…ã—ã€èª°ã‚‚é£¢ãˆã•ã›ãªã„å®‰å®šé‹è¡ŒãŒæŒã¡å‘³ã§ã™ã€‚æ´¾æ‰‹ãªæ¼”å‡ºã¯æ§ãˆã‚ã§ã‚‚ã€é£Ÿä½“é¨“ã®æ¿ƒã•ã§ç´å¾—ã•ã›ã‚‹ã‚¿ã‚¤ãƒ—ã€‚å¤‰åŒ–çƒã‚’æ±‚ã‚ã‚‹ç›¸æ‰‹ã«ã¯å˜èª¿ã«è¦‹ãˆã‚‹ã“ã¨ãŒã‚ã‚‹ãŸã‚ã€ä¸­ç›¤ã«å­£ç¯€ã®ä¸€çš¿ã‚„é¦™ã‚Šæ¼”å‡ºã‚’å°‘ã—æŒŸã‚€ã¨æ˜ ãˆã¾ã™ã€‚",
    tips:["â€œåç‰©â†’åç‰©â€ã§æ®µå–ã‚Šè‰¯ã","ä¼šè¨ˆ/å¸­æ›¿ãˆã‚’ä¸»å°","å†™çœŸã¯å°‘ãªã‚ä½“é¨“æ¿ƒã"]},
  "ã‚µãƒ¼ãƒ­ã‚¤ãƒ³ç‹":{v:[1.3,0.8,0.5,0.8], one:"è¯ã‚„ãã®æ¼”å‡ºå®¶",
    catch:"è¯ã‚„ã‹æ¼”å‡ºã§å ´ã‚’ç‰½å¼•ã€‚",
    desc:"è¯ã‚„ãã®æ¼”å‡ºå®¶ã€‚ãƒ•ãƒ©ãƒ³ãƒ™ã‚„é¦™ã‚Šã®è¦‹ã›å ´ã€å†™çœŸã«æ˜ ãˆã‚‹ç››ã‚Šä»˜ã‘ã§å ´ã‚’æ˜ã‚‹ãç‰½å¼•ã—ã¾ã™ã€‚ç”˜æ¿ƒãƒªãƒƒãƒã‚‚å­ã‚ãšâ€œä»Šæ—¥ã¯æ¥½ã—ã‚‚ã†â€ã®æ——ã‚’æŒ¯ã‚‹ç¤¾äº¤å®¶ã‚¿ã‚¤ãƒ—ã€‚å‹¢ã„ã§é£Ÿã¹éããƒ»é‡ããªã‚Šéãã«æ³¨æ„ã—ã¤ã¤ã€å‰åŠã¯æ˜ ãˆã€å¾ŒåŠã¯èµ¤èº«ã§æ•´ãˆã‚‹ã¨å…¨å“¡ã®æº€è¶³åº¦ãŒä¼¸ã³ã¾ã™ã€‚é™ã‹ãªç›¸æ‰‹ã«ã¯ãƒšãƒ¼ã‚¹ã‚’è½ã¨ã—ã¦ä¼šè©±ã®èãå½¹ã¸å›ã‚‹ã¨å¥½ç›¸æ€§ã€‚",
    tips:["ãƒ•ãƒ©ãƒ³ãƒ™/é¦™ã‚Šæ¼”å‡ºã§æ‹æ‰‹","ä¹¾æ¯ã®éŸ³é ­ã§æ˜ã‚‹ãé–‹å§‹","éš£å¸­ã¨ã‚‚è»½ãä¹¾æ¯"]},
  "ç¾é£Ÿå®¶ã‚¶ãƒ–ãƒˆãƒ³":{v:[1.0,0.2,-0.3,0.2], one:"ã—ã£ã¨ã‚Šæ¿ƒåšæ´¾",
    catch:"ã—ã£ã¨ã‚Šæ¿ƒåšã€å°‘é‡é«˜æº€è¶³ã€‚",
    desc:"æ¿ƒåšã‚’å°‘é‡ã€ã‚†ã£ãã‚Šæ·±ãã€‚å£ã©ã‘ã¨é¦™ã‚Šã®å±¤ã‚’æ™‚é–“ã‚’ã‹ã‘ã¦å‘³ã‚ã†â€œå¤§äººã®æº€è¶³â€å¿—å‘ã§ã™ã€‚èµ¤ãƒ¯ã‚¤ãƒ³ã‚„è½ã¡ç€ã„ãŸå¸­ã‚’å¥½ã¿ã€ä¼šè©±ã‚‚è…°ã‚’æ®ãˆã¦ã€‚é‡ã¯æŠ‘ãˆã¦ã‚‚ä½“é¨“ã®å¯†åº¦ã¯é«˜ãã€ä½™éŸ»ã‚’å¤§åˆ‡ã«ã—ã¾ã™ã€‚é£Ÿã¹å¿œãˆé‡è¦–ã®ãƒ¡ãƒ³ãƒãƒ¼ã«ã¯ç‰©è¶³ã‚Šãªã•ãŒå‡ºã‚„ã™ã„ã®ã§ã€ç· ã‚ã«é¦™ã°ã—ã„ä¸€çš¿ã‚’åˆã‚ã›ã‚‹ã¨å…¨ä½“ãŒè±Šã‹ã«ã€‚å†™çœŸã‚ˆã‚Šè¨˜æ†¶ã«æ®‹ã‚‹å¤œã‚’ä½œã‚‹åè„‡å½¹ã€‚",
    tips:["â€œå°‘é‡é«˜æº€è¶³â€ã‚’ææ¡ˆ","ä¼‘ã¾ã›æ™‚é–“ã‚’å¤§åˆ‡ã«","æ·±ã‚ã®è³ªå•ã‚’1ã¤"]},
  "ã‚®ãƒ£ãƒ«ã‚«ãƒ«ãƒ“":{v:[1.2,0.7,0.9,0.9], one:"å·»ãè¾¼ã¿å‹ã‚¨ãƒ³ã‚¿ãƒ¡",
    catch:"ç”˜æ¿ƒã‚¨ãƒ³ã‚¿ãƒ¡ã§å·»ãè¾¼ã¿å‹ã€‚",
    desc:"ç”˜æ¿ƒã‚¨ãƒ³ã‚¿ãƒ¡ã§çš†ã‚’å·»ãè¾¼ã‚€ç››ã‚Šä¸Šã’å½¹ã€‚å£°ã‹ã‘ã€ã‚·ã‚§ã‚¢ã€æ’®å½±ã®æ®µå–ã‚Šã¾ã§æ¥½ã—ãå›ã—ã€æº€è¶³åº¦ã®é«˜ã„â€œåˆ†ã‹ã‚Šã‚„ã™ã„ç¾å‘³ã—ã•â€ã‚’æä¾›ã—ã¾ã™ã€‚ãƒ†ãƒ³ãƒã¯é€Ÿã‚ã§ã€ç©ºè…¹ã‚‚é€€å±ˆã‚‚æ”¾ç½®ã—ãªã„å®Ÿè¡ŒåŠ›ãŒé­…åŠ›ã€‚é¨’ãŒã—ã•ã‚„é£Ÿã¹éãã«ã¯è¦æ³¨æ„ã€‚é€”ä¸­ã§èµ¤èº«ã‚„ã‚µãƒ©ãƒ€ã‚’æŒŸã¿ã€ãƒšãƒ¼ã‚¹ã«æŠ‘æšã‚’ã¤ã‘ã‚‹ã¨å¹…ãŒåºƒãŒã‚Šã€ç¹Šç´°æ´¾ã¨ã‚‚æ°—æŒã¡ã‚ˆãå…±å­˜ã§ãã¾ã™ã€‚",
    tips:["â€œã¿ã‚“ãªã®ä¸€å£ã‚«ãƒ«ãƒ“â€æ‰‹é…","è‡ªåˆ†ãŒæ’®ã£ã¦ã‚·ã‚§ã‚¢","æº€è¶³æ´¾ã®å¸Œæœ›ã‚’æ‹¾ã†"]},
  "ã‚„ã‚Šæ‰‹ã®å–¶æ¥­ãƒãƒ³ãƒãƒ©ãƒŸ":{v:[0.2,0.4,0.8,0.3], one:"ãƒ†ãƒ³ãƒã®å¸ä»¤å¡”",
    catch:"ãƒ†ãƒ³ãƒè‰¯ãçµæœã‚’å‡ºã™å®Ÿåˆ©æ´¾ã€‚",
    desc:"åŠ¹ç‡ã‚ˆãçµæœã‚’å‡ºã™å®Ÿåˆ©æ´¾ã€‚ç„¼ãå°ç®¡ç†ã‚„è¿½åŠ ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã«å¼·ãã€èµ¤èº«ä¸­å¿ƒã§ãƒ†ãƒ³ãƒã‚ˆãå›ã—ã¾ã™ã€‚æ®µå–ã‚Šã¨å£°æ›ã‘ã§åœæ»ã‚’ãªãã™ä¸€æ–¹ã€æ€¥ãéãã‚‹ã¨â€œè½ã¡ç€ã‹ãªã„â€å°è±¡ã«ã€‚è¦æ‰€ã§ä¸€çš¿ã‚’ã˜ã£ãã‚Šå‘³ã‚ã†æ™‚é–“ã‚’ç½®ãã€ç”˜æ¿ƒç³»ã‚’ä¸€ç‚¹æŠ•å…¥ã™ã‚‹ã¨æº€è¶³åº¦ãŒä¸ŠãŒã‚Šã¾ã™ã€‚ä¼šè©±ã‚‚â€œç«¯çš„â†’ä¸€è¨€æ·±æ˜ã‚Šâ€ã‚’æ„è­˜ã™ã‚‹ã¨ã€ä»•äº‹åŠ›ã ã‘ã§ãªãè‰²æ°—ã‚‚ä¼ã‚ã‚‹ã‚¿ã‚¤ãƒ—ã€‚",
    tips:["å›è»¢ã‚’ä¸Šã’ã¦é–“ã‚’ä½œã‚‰ãªã„","ç„¼ãå°ç®¡ç†å½¹ã§æ´»èº","é£²ã¿ã™ãæ³¨æ„ã§ç¬‘é¡”ã‚­ãƒ¼ãƒ—"]},
  "ã‚«ã‚¤ãƒãƒŸèˆå¦“ã¯ã‚“":{v:[0.5,-0.2,0.2,0.2], one:"è»½ãƒªãƒƒãƒã®ã‚³ãƒ¼ãƒ‡",
    catch:"è»½ã‚„ã‹æ´¾ã®æ©‹æ¸¡ã—ã€‚",
    desc:"è»½ã‚„ã‹ãªãƒªãƒƒãƒã‚’ä¸Šå“ã«ã‚³ãƒ¼ãƒ‡ã€‚å¡©ã§ç´ æã‚’ç«‹ãŸã›ã€ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’è¦‹ã¦ã‚¿ãƒ¬ã§æº€è¶³æ„Ÿã‚’è¶³ã™â€œæ©‹æ¸¡ã—å½¹â€ã§ã™ã€‚æŸ”ã‚‰ã‹ãªå£å½“ãŸã‚Šã§ä¸‡äººå—ã‘ã—ã€ä¼šè©±ã‚’é‚ªé­”ã—ãªã„æ§ãˆã‚ãªè¯ã‚„ã‹ã•ãŒé­…åŠ›ã€‚ä½™ç™½ã‚’æ®‹ã™ç· ã‚æ–¹ã‚‚å¾—æ„ã€‚ä¸»å¼µãŒå¼±ãè¦‹ãˆã‚‹ã“ã¨ãŒã‚ã‚‹ãŸã‚ã€ã©ã“ã‹ã§å°ã•ãªã‚µãƒ—ãƒ©ã‚¤ã‚ºã‚’ç”¨æ„ã™ã‚‹ã¨å°è±¡ãŒãã£ã¨å¼·ã¾ã‚Šã¾ã™ã€‚",
    tips:["â€œå¡©â†’ã‚¿ãƒ¬â€ã§ãƒ¡ãƒªãƒãƒª","è»½ã„ç· ã‚ã§ä½™ç™½ã‚’æ®‹ã™","ç›¸æ‰‹ã®å¾—æ„ãƒˆãƒ¼ã‚¯ã‚’æŒ¯ã‚‹"]},
  "æ›¸é“å®¶ãƒŸã‚¹ã‚¸":{v:[0.4,-0.4,-0.5,0.2], one:"ç¹Šç´°ã•ã®è·äºº",
    catch:"å£ã©ã‘ä¸Šå“ã€æ‰€ä½œã§é­…ã›ã‚‹ã€‚",
    desc:"ç¹Šç´°ã•ã®è·äººã€‚ç«å…¥ã‚Œã¯æ§ãˆã‚ã€å£ã©ã‘ã®è‰¯ã•ã¨èˆŒè§¦ã‚Šã«ä¾¡å€¤ã‚’ç½®ãã€æ‰€ä½œã‚„æ°—é…ã‚Šã§ç›¸æ‰‹ã‚’å¿ƒåœ°ã‚ˆãã•ã›ã¾ã™ã€‚å°‘é‡ãšã¤å…±æœ‰ã—ã€è¨€è‘‰ã‚‚ä¸å¯§ã§èŠ¯ãŒé€šã‚‹ã‚¿ã‚¤ãƒ—ã€‚è³‘ã‚„ã‹ãªå ´ã ã¨åŸ‹ã‚‚ã‚ŒãŒã¡ãªãŸã‚ã€é™ã‹ãªå¸­ã‚„ç…§æ˜ã‚’é¸ã¶ã¨çœŸä¾¡ã‚’ç™ºæ®ã€‚ç”˜ã‚ã¯é‡ã‚’çµã£ã¦å“ã‚ˆãã€‚å†™çœŸã‚ˆã‚Šâ€œä½“é¨“ã®ç¾ã—ã•â€ã‚’æ®‹ã™ã€é€šå¥½ã¿ã®ç›¸æ‰‹ã«åˆºã•ã‚‹ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã§ã™ã€‚",
    tips:["ç«å…¥ã‚Œã¯æ§ãˆã‚ã§å…±æœ‰","å°å£°ã®ãƒ„ãƒƒã‚³ãƒŸã§è·é›¢ç¸®ã‚","ç”˜ã‚ã¯é‡ã‚’çµã£ã¦ææ¡ˆ"]},
  "ã‚·ãƒ£ãƒˆãƒ¼ãƒ–ãƒªã‚¢ãƒ³å¥³ç‹":{v:[-1.3,-0.2,-0.6,0.4], one:"å¯¡é»™ãªå¯©ç¾å®¶",
    catch:"ç‰¹é¸ä¸€ç‚¹ä¸»ç¾©ã€‚é™ã‹ã«æ·±ãã€‚",
    desc:"é‡ã‚ˆã‚Šè³ªã®å¯©ç¾å®¶ã€‚é¸ã¶å“ã¯å°‘æ•°ç²¾é‹­ã€èª¬æ˜ã‚’èãã€é¦™ã‚Šãƒ»æ¸©åº¦ãƒ»é£Ÿæ„Ÿã¾ã§ä¸€ç‚¹é›†ä¸­ã§å‘³ã‚ã„ã¾ã™ã€‚å¸­ã‚„å™¨ã«ã‚‚ç›®ãŒåˆ©ãã€è½ã¡ç€ã„ãŸç©ºæ°—ã‚’ä½œã‚‹å­˜åœ¨ã€‚é ‘å›ºã«è¦‹ã‚‰ã‚Œã‚„ã™ã„ä¸€é¢ãŒã‚ã‚‹ã®ã§ã€ç›¸æ‰‹ã®å¥½ã¿ã‚‚ä¸€æœ¬å·®ã—è¾¼ã‚€ä½™åœ°ã‚’æ®‹ã™ã¨é–¢ä¿‚ãŒå††æ»‘ã«ã€‚è±ªè¯ã•ã«æµã•ã‚Œãšã€é™ã‹ã«æ·±ãâ€œè‰¯ã„ã‚‚ã®ã‚’å…±æœ‰ã™ã‚‹â€æ„Ÿè¦šã‚’è‚²ã¦ã‚‹ã®ãŒå¾—æ„ã§ã™ã€‚",
    tips:["â€œé‡ã‚ˆã‚Šè³ªâ€ã§è»¸ã‚’è¦‹ã›ã‚‹","é™ã‹ãªå¸­ã‚’é¸ã¶","ãƒ‡ã‚¶ãƒ¼ãƒˆå‰ã«æ¬¡å›ã®ç´„æŸ"]}
};

// 20å•
const Q = [
  {t:"åŒã˜ä¾¡æ ¼ãªã‚‰ã©ã¡ã‚‰ã‚’é¸ã¶ï¼Ÿ", a:"ã‚­ãƒ¬é‡è¦–ï¼ˆã•ã£ã±ã‚Šï¼‰", b:"ã‚³ã‚¯é‡è¦–ï¼ˆæ¿ƒåšï¼‰", ax:"A"},
  {t:"æº€è¶³åº¦é‡è¦–ãªã‚‰ï¼Ÿ", a:"ãƒ’ãƒ¬ãƒ»ãƒ©ãƒ³ãƒ—ãªã©èµ¤èº«", b:"ãƒªãƒ–ãƒ­ãƒ¼ã‚¹ãƒ»ã‚µãƒ¼ãƒ­ã‚¤ãƒ³", ax:"A"},
  {t:"è„‚ã®é‡ã•ã®å¥½ã¿ã¯ï¼Ÿ", a:"è»½ã‚ã®èµ¤èº«å¯„ã‚Š", b:"è„‚ã®æ¿ƒåšã•ã‚‚æ¬²ã—ã„", ax:"A"},
  {t:"â€œé‡ã‚’ã—ã£ã‹ã‚Šâ€é£Ÿã¹ã‚‹ãªã‚‰ï¼Ÿ", a:"è»½ã‚ã®èµ¤èº«ä¸­å¿ƒã§é€²ã‚ãŸã„", b:"æº€è¶³æ„Ÿã®é«˜ã„éƒ¨ä½ã§æŠ¼ã—ãŸã„", ax:"B"},
  {t:"ãƒœãƒªãƒ¥ãƒ¼ãƒ æ„Ÿã®ç†æƒ³ã¯ï¼Ÿ", a:"å°‘é‡Ã—å¤šçš¿ã§è‰²ã€…", b:"é‡æ„Ÿã‚ã£ã¦OK", ax:"B"},
  {t:"æœ€åˆã®ä¸€çš¿ã¯ï¼Ÿ", a:"è»½ã‚„ã‹ã«å¡©ã§", b:"æœ€åˆã‹ã‚‰åç‰©ãƒªãƒƒãƒ", ax:"D"},
  {t:"è¿½åŠ ã®ä¸€çš¿ãªã‚‰ï¼Ÿ", a:"èµ¤èº«ç³»ã§ã‚‚ã†ä¸€çš¿", b:"ãƒªãƒƒãƒç³»ã§ã‚‚ã†ä¸€çš¿", ax:"B"},
  {t:"æ¼”å‡ºã®å¥½ã¿ã¯ï¼Ÿ", a:"ç´ æœ´ãƒ»ç´ ææ¨ã—", b:"æ˜ ãˆãƒ»ã‚½ãƒ¼ã‚¹æ¨ã—", ax:"D"},
  {t:"ãƒ†ãƒ¼ãƒ–ãƒ«ã®é›°å›²æ°—ã¯ï¼Ÿ", a:"é™ã‹ã«å‘³ã‚ã†ã®ãŒå¥½ã", b:"è³‘ã‚„ã‹ã«æ¥½ã—ã¿ãŸã„", ax:"C"},
  {t:"åˆã‚ã¾ã—ã¦ã®å¸­ã§ã®ç«‹ã¡å›ã‚Šã¯ï¼Ÿ", a:"ã¾ãšç›¸æ‰‹ã«åˆã‚ã›ã‚‹", b:"æ˜ã‚‹ãä¸»å°ã—ã¦ã„ã", ax:"C"},
  {t:"ç„¼ãæ–¹ã®å‚¾å‘ã¯ï¼Ÿ", a:"æ§ãˆã‚ãƒ¬ã‚¢å¯„ã‚Š", b:"é¦™ã°ã—ã‚ãŒå¥½ã¿", ax:"A"},
  {t:"ä¹¾æ¯ãƒ‰ãƒªãƒ³ã‚¯ã¯ï¼Ÿ", a:"è»½ã‚„ã‹/ã‚¹ãƒ‘ãƒ¼ã‚¯ãƒªãƒ³ã‚°", b:"æ¿ƒã„ã‚/ã‚«ã‚¯ãƒ†ãƒ«", ax:"D"},
  {t:"çš¿æ•°ã®å¿—å‘ã¯ï¼Ÿ", a:"å°‘é‡å¤šçš¿ã§å¤‰åŒ–ã‚’æ¥½ã—ã‚€", b:"ä¸»å½¹ã‚’ãŒã£ã¤ã‚Š", ax:"B"},
  {t:"å†™çœŸã®æ‰±ã„ã¯ï¼Ÿ", a:"å°‘ãªã‚ã§ä½“é¨“é‡è¦–", b:"ã—ã£ã‹ã‚Šæ’®ã£ã¦ã‚·ã‚§ã‚¢", ax:"D"},
  {t:"ä¼šè©±ãƒ†ãƒ³ãƒã¯ï¼Ÿ", a:"ã‚†ã£ãã‚Šä¸å¯§ã«æ·±ã", b:"ãƒ†ãƒ³ãƒè‰¯ãæ˜ã‚‹ã", ax:"C"},
  {t:"é¦™ã‚Šã®å¥½ã¿ã¯ï¼Ÿ", a:"ç´ æã®é¦™ã‚ŠãŒç«‹ã¤æ–¹", b:"é¦™ã‚Šæ¼”å‡ºã‚‚å¥½ã", ax:"D"},
  {t:"ç· ã‚ã®é¸ã³æ–¹ã¯ï¼Ÿ", a:"è»½ãä½™ç™½ã‚’æ®‹ã™", b:"æº€è¶³å„ªå…ˆã§ã—ã£ã‹ã‚Š", ax:"B"},
  {t:"åç‰©ã¨è¨€ã‚ã‚ŒãŸã‚‰ï¼Ÿ", a:"æ°—ã«ãªã‚‹ãŒæ§˜å­è¦‹", b:"ã¾ãšã¯åç‰©ã§ã„ã", ax:"C"},
  {t:"å¥½ã¿ã®å‘³å¹…ã¯ï¼Ÿ", a:"èµ¤èº«ã€œè»½ãƒªãƒƒãƒ", b:"æ¿ƒåšã€œç”˜ã‚ã‚‚OK", ax:"A"},
  {t:"å¸­æ›¿ãˆã®ç†æƒ³ã¯ï¼Ÿ", a:"å°‘ãªã‚ã§ã˜ã£ãã‚Š", b:"å¤šã‚ã§åºƒãäº¤æµ", ax:"C"},
];

/* ====== ãƒ˜ãƒ«ãƒ‘ ====== */
const qs = s=>document.querySelector(s);
const el = (t,attrs={},html="")=>{const e=document.createElement(t);Object.entries(attrs).forEach(([k,v])=>e.setAttribute(k,v));e.innerHTML=html;return e;}
const clamp = (x,a,b)=>Math.max(a,Math.min(b,x));
const to01 = n => Math.min(1, Math.max(0, (n + 2) / 4)); // -2..+2 â†’ 0..1
function v5to2(x){ return ((x||3)-3)/2*2 } // 1..5 â†’ -2..+2

/* ====== ç”»é¢é·ç§» ====== */
function go(n){
  ["#step0","#step1","#step2","#err"].forEach(sel=>qs(sel).classList.remove("active"));
  if(n===0) qs("#step0").classList.add("active");
  if(n===1) qs("#step1").classList.add("active");
  if(n===2) qs("#step2").classList.add("active");
}

/* ====== ã‚¿ã‚¤ãƒ—ä¸€è¦§ï¼ˆStep0ï¼‰ ====== */
function renderTypeGrid(){
  const g = qs("#typeGrid"); g.innerHTML="";
  Object.entries(TYPES).forEach(([name,obj])=>{
    const c = el("div",{class:"card"});
    c.innerHTML = `<img src="${IMGS[name]||''}" alt="${name}">
      <div><b>${name}</b><div class="small">${obj.one}</div></div>`;
    g.appendChild(c);
  });
}

/* ====== ã‚¯ã‚¤ã‚ºæç”»ï¼ˆStep1ï¼‰ ====== */
let page=0;        // 0..3
let answers=Array(Q.length).fill(0); // 1..5

function renderPage(){
  const from=page*5, to=from+5;
  qs("#pp").textContent = `Q${from+1}â€“${to} / 20`;
  qs("#progFill").style.width = `${Math.round((answers.filter(Boolean).length/20)*100)}%`;

  const wrap = qs("#qgrid"); wrap.innerHTML="";
  Q.slice(from,to).forEach((q,i)=>{
    const idx = from+i;
    const box = el("div",{class:"qbox"});
    const html = `
      <div class="qtitle">${q.t}</div>
      <div class="small" style="margin-bottom:8px">Aï¼š${q.a}ã€€/ã€€Bï¼š${q.b}</div>
      <div class="scale">
        ${[1,2,3,4,5].map(v=>{
          const mid = v===3?' mid':''; const sel = answers[idx]===v?' sel':'';
          return `<div class="opt${mid}${sel}" data-idx="${idx}" data-val="${v}" aria-label="${v}">${v===1?'A':v===5?'B':v===3?'â—':'ãƒ»'}</div>`;
        }).join('')}
      </div>`;
    box.innerHTML = html;
    wrap.appendChild(box);
  });

  qs("#prevBtn").disabled = (page===0);
  qs("#nextBtn").textContent = (page===3?'çµæœã‚’è¦‹ã‚‹ â†’':'æ¬¡ã®5å• â†’');
}

function clickScale(e){
  const t = e.target.closest(".opt"); if(!t) return;
  const idx = +t.dataset.idx, val = +t.dataset.val;
  answers[idx]=val;
  renderPage();

  const from=page*5, done = answers.slice(from,from+5).every(v=>v>0);
  if(done){
    setTimeout(()=>{ if(page<3){page++; renderPage(); go(1);} else {showResult();} }, 300);
  }
}

function nextPage(){
  const from=page*5;
  if(!answers.slice(from,from+5).every(v=>v>0)){
    alert("æœªå›ç­”ãŒã‚ã‚Šã¾ã™ï¼ˆã“ã®5å•ã‚’ã™ã¹ã¦é¸ã‚“ã§ãã ã•ã„ï¼‰");
    return;
  }
  if(page<3){ page++; renderPage(); }
  else { showResult(); }
}
function prevPage(){ if(page>0){ page--; renderPage(); } }

// ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ 1..5
window.addEventListener('keydown',e=>{
  const n = +e.key;
  if(n>=1 && n<=5 && qs('#step1').classList.contains('active')){
    const from=page*5, to=from+5;
    let idx = answers.findIndex((v,i)=> i>=from && i<to && v===0);
    if(idx<0) idx=from;
    answers[idx]=n;
    renderPage();
    const done = answers.slice(from,to).every(v=>v>0);
    if(done){
      setTimeout(()=>{ if(page<3){page++; renderPage();} else {showResult();} }, 150);
    }
  }
});

/* ====== çµæœï¼ˆStep2ï¼‰ ====== */
const AXIS_MAP = Q.map(q=>q.ax);

function buildAxis(){
  const acc={A:[],B:[],C:[],D:[]};
  answers.forEach((v,i)=>{ acc[AXIS_MAP[i]].push( v5to2(v) ); });
  const avg = k => acc[k].length ? (acc[k].reduce((s,x)=>s+x,0)/acc[k].length) : 0;
  return {A:avg('A'),B:avg('B'),C:avg('C'),D:avg('D')};
}
function decideType(axis){
  const w={A:1.2,B:1.0,C:0.9,D:0.8};
  let best=null,bestDist=1e9;
  for(const [name,o] of Object.entries(TYPES)){
    const [a,b,c,d]=o.v;
    const dist=w.A*(axis.A-a)**2+w.B*(axis.B-b)**2+w.C*(axis.C-c)**2+w.D*(axis.D-d)**2;
    if(dist<bestDist){bestDist=dist;best=name;}
  }
  return best;
}
function bestPartner(selfName, axis){
  const w={A:0.8,B:1.0,C:1.2,D:0.9};
  let best=null,score=1e9;
  for(const [name,o] of Object.entries(TYPES)){
    if(name===selfName) continue;
    const [a,b,c,d]=o.v;
    const s = w.A*(axis.A-(-0.4*a))**2 + w.B*(axis.B-b)**2 + w.C*(axis.C-c)**2 + w.D*(axis.D-(-0.3*d))**2;
    if(s<score){score=s;best={name,why:explainPair(axis,o.v)};}
  }
  return best;
}
function explainPair(ax,v){
  const labsC = Math.abs(ax.C - v[2])<0.5 ? "ãƒ†ãƒ³ãƒæ„ŸãŒè¿‘ã„" : "ãƒ†ãƒ³ãƒã‚’è£œå®Œã—åˆã†";
  const labsB = Math.abs(ax.B - v[1])<0.5 ? "é‡æ„Ÿã®å¥½ã¿ãŒè¿‘ã„" : "é‡æ„Ÿã®ãƒãƒ©ãƒ³ã‚¹ãŒå–ã‚Œã‚‹";
  const labsA = ax.A>0 ? "æ¿ƒåšå¯„ã‚Š" : "èµ¤èº«å¯„ã‚Š";
  return `${labsC}ï¼‹${labsB}ã€‚å¥½ã¿ã¯${labsA}ã‚’è£œå®Œã€‚`;
}

function showResult(){
  if(answers.filter(Boolean).length<20){ qs("#err").style.display='block'; return; }
  const axis = buildAxis();
  const you  = decideType(axis);
  const t    = TYPES[you];

  // ãƒ¡ã‚¤ãƒ³
  qs("#typeName").textContent  = you;
  qs("#typeCatch").textContent = t.catch;
  qs("#typeDesc").textContent  = t.desc || "";
  qs("#heroImg").src           = IMGS[you]||"";
  qs("#heroImg").alt           = you;

  const tips = qs("#tips"); tips.innerHTML="";
  (t.tips||[]).forEach(s=>tips.appendChild(el("span",{class:"btn slim"},s)));

  // è»¸ãƒãƒ¼
  const bars = qs("#bars"); bars.innerHTML="";
  [["é¢¨å‘³ Aï¼ˆèµ¤èº«â†”æ¿ƒåšï¼‰",to01(axis.A)],
   ["é‡ Bï¼ˆè»½ã‚â†”ãƒœãƒªãƒ¥ãƒ¼ãƒ ï¼‰",to01(axis.B)],
   ["ãƒ†ãƒ³ãƒ Cï¼ˆé™ã‹â†”ã«ãã‚„ã‹ï¼‰",to01(axis.C)],
   ["æ¼”å‡º Dï¼ˆç´ æœ´â†”æ˜ ãˆï¼‰",to01(axis.D)]]
  .forEach(([label,ratio])=>{
    const row = el("div",{class:"bar"});
    row.innerHTML = `<div class="small">${label}</div>
      <div class="track"><div class="fill" style="width:${Math.round(ratio*100)}%"></div></div>`;
    bars.appendChild(row);
  });

  // ç›¸æ€§No.1 ã¨ è¿‘ã„ã‚¿ã‚¤ãƒ—ï¼ˆå›ç­”ã«å¿œã˜ã¦æ¯å›å¤‰åŒ–ï¼‰
  const pair = bestPartner(you, axis);
  if(pair){
    qs("#pairName").textContent = pair.name;
    qs("#pairImg").src = IMGS[pair.name]||"";
    qs("#pairImg").alt = pair.name;
    qs("#pairWhy").textContent = pair.why;
  }
  const distances = Object.entries(TYPES).map(([name,o])=>{
    const [a,b,c,d]=o.v;
    const dist=(axis.A-a)**2+(axis.B-b)**2+(axis.C-c)**2+(axis.D-d)**2;
    return {name,dist};
  }).sort((x,y)=>x.dist-y.dist);
  const second = distances.find(x=>x.name!==you && (!pair || x.name!==pair.name));
  if(second){
    qs("#secondName").textContent = second.name;
    qs("#secondImg").src = IMGS[second.name]||"";
    qs("#secondImg").alt = second.name;
  }

  go(2);
}

/* ====== åˆæœŸåŒ– ====== */
renderTypeGrid();
qs("#startBtn").onclick = ()=>{ page=0; answers=Array(Q.length).fill(0); renderPage(); go(1); }
qs("#qgrid").addEventListener("click", clickScale);
qs("#nextBtn").onclick = nextPage;
qs("#prevBtn").onclick = prevPage;
qs("#againBtn").onclick = ()=>{ page=0; answers=Array(Q.length).fill(0); renderPage(); go(1); };
</script>
</body>
</html>
