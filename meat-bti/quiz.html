<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Meat BTI è¨ºæ–­ï½œè³ªå•</title>
<meta name="theme-color" content="#0b0e17">
<style>
  :root{
    --bg:#0b0e17; --panel:#121828; --panel-2:#0f1524; --ink:#e9eef8; --muted:#98a2b3; --accent:#7aa2ff;
    --red:#ff6b6b; --green:#22c55e; --amber:#facc15; --line:#1f2a44; --brand:#9b87f5;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;background:radial-gradient(1200px 700px at 50% -10%,#111a30 0%,#0b0e17 60%);color:var(--ink);
    font-family: system-ui,-apple-system,"Segoe UI",Roboto,"Hiragino Kaku Gothic ProN","Meiryo",sans-serif; letter-spacing:.02em}
  a{color:inherit;text-decoration:none}
  .container{width:min(1100px,94vw);margin:0 auto;padding:18px 0 80px}

  /* Header */
  .topbar{display:flex;align-items:center;gap:10px;position:sticky;top:0;z-index:10;
    background:linear-gradient(180deg,rgba(11,14,23,.95),rgba(11,14,23,.75));backdrop-filter:blur(6px);
    border-bottom:1px solid var(--line);padding:10px 0}
  .brand{display:flex;align-items:center;gap:10px;font-weight:900}
  .badge{display:inline-grid;place-items:center;width:28px;height:28px;border-radius:8px;
    background:conic-gradient(from 140deg,#ffd966,#ff6b4a);color:#0e0b07}
  .ghost{margin-left:auto;display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border:1px solid var(--line);border-radius:10px;color:var(--muted)}
  .ghost:hover{border-color:#2a3a60}

  /* Progress */
  .progress{margin:14px 0 8px;background:var(--panel);border:1px solid var(--line);border-radius:10px;overflow:hidden}
  .bar{height:8px;background:linear-gradient(90deg,#66d2ff,#7aa2ff,#9b87f5);width:0%}
  .meta{display:flex;justify-content:space-between;color:var(--muted);font-size:13px;margin-top:6px}

  /* Grid of 5 cards */
  .grid{display:grid;grid-template-columns:1fr;gap:14px}
  @media(min-width:900px){.grid{grid-template-columns:1fr 1fr}}
  .card{background:linear-gradient(180deg,var(--panel),var(--panel-2));border:1px solid var(--line);border-radius:14px; padding:14px 14px 12px}
  .qhead{display:flex;align-items:center;gap:10px;margin-bottom:8px}
  .pill{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;border:1px solid var(--line);color:var(--muted);font-size:12px}
  .title{font-weight:800;margin:2px 0 4px}
  .labels{display:flex;justify-content:space-between;color:var(--muted);font-size:13px;margin:6px 0 8px}
  .dots{display:flex;gap:8px;justify-content:center}
  .dot{width:36px;height:36px;border-radius:999px;border:2px solid #2a3860;background:#0d1324;cursor:pointer;
    transition:transform .06s ease, box-shadow .12s ease, background .12s ease}
  .dot:hover{transform:translateY(-1px);box-shadow:0 6px 18px rgba(0,0,0,.25)}
  .dot[data-v="1"],.dot[data-v="2"]{border-color:#3a78ff}
  .dot[data-v="4"],.dot[data-v="5"]{border-color:#ff6b6b}
  .dot.active[data-v="1"],.dot.active[data-v="2"]{background:#204a9e}
  .dot.active[data-v="4"],.dot.active[data-v="5"]{background:#7a2930}
  .dot[data-v="3"]{border-color:#b08900}
  .dot.active[data-v="3"]{background:var(--amber);box-shadow:0 0 0 3px rgba(250,204,21,.2) inset}
  .scale-help{display:flex;justify-content:space-between;color:var(--muted);font-size:11px;margin-top:6px}
  .hint{color:#9fb2d6;font-size:12px;margin-top:6px}

  /* Nav */
  .nav{display:flex;justify-content:flex-end;gap:10px;margin-top:14px}
  .btn{appearance:none;border:1px solid var(--line);background:#141b31;color:var(--ink);padding:10px 16px;border-radius:12px;cursor:pointer;font-weight:800}
  .btn[disabled]{opacity:.45;cursor:not-allowed}
  .btn.primary{background:linear-gradient(180deg,#ffd166,#f9c23c);color:#332100;border:none}
  .btn.secondary{background:#192443}
  .center{display:flex;justify-content:center;margin-top:14px}
  .note{color:var(--muted);font-size:12px;margin-top:8px}

  /* Page dots */
  .steps{display:flex;gap:8px;justify-content:center;margin:10px 0 2px}
  .steps span{width:8px;height:8px;border-radius:50%;background:#2a365a}
  .steps span.active{background:#7aa2ff}

  /* keyboard helper */
  .kbd{border:1px solid var(--line);border-bottom-width:2px;border-right-width:2px;border-radius:6px;padding:2px 6px;font-size:12px;color:#b8c1d9}

</style>
</head>
<body>
  <div class="topbar">
    <div class="container" style="display:flex;align-items:center;gap:12px">
      <div class="brand"><div class="badge">ğŸ¥©</div><div>Meat BTI è¨ºæ–­</div></div>
      <a class="ghost" href="../">â† LPã¸æˆ»ã‚‹</a>
    </div>
  </div>

  <div class="container">
    <div class="progress" aria-hidden="true"><div class="bar" id="bar"></div></div>
    <div class="meta"><div id="progressLabel">0 / 20</div><div>é¸æŠã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆï¼š<span class="kbd">1</span> â€¦ <span class="kbd">5</span></div></div>
    <div class="steps" id="steps"></div>

    <div id="grid" class="grid" aria-live="polite"></div>

    <div class="nav">
      <button id="prev" class="btn secondary">å‰ã®5å•</button>
      <button id="next" class="btn">æ¬¡ã®5å•ã¸</button>
      <button id="result" class="btn primary" style="display:none">çµæœã‚’è¦‹ã‚‹</button>
    </div>
    <div class="center"><div class="note">å„è¨­å•ã¯å·¦ã€ŒAå¯„ã‚Šã€â†” å³ã€ŒBå¯„ã‚Šã€ã€‚<b>ä¸­å¤®ï¼ˆ3ï¼‰ã¯ä¸­ç«‹</b>ã§ã€<b style="color:#facc15">é»„è‰²ãƒœã‚¿ãƒ³</b>ã§ã™ã€‚</div></div>
  </div>

<script>
/* -------------------------
  è¨­å•ãƒ‡ãƒ¼ã‚¿ï¼ˆ20å• / 5å•Ã—4ãƒšãƒ¼ã‚¸ï¼‰
  text: ã‚¿ã‚¤ãƒˆãƒ«
  a: å·¦å´ï¼ˆAå¯„ã‚Šï¼‰ãƒ©ãƒ™ãƒ«
  b: å³å´ï¼ˆBå¯„ã‚Šï¼‰ãƒ©ãƒ™ãƒ«
-------------------------- */
const QUESTIONS = [
  {text:"åŒã˜ä¾¡æ ¼ã®èµ¤èº«ã¨éœœé™ã‚Šã€ä»Šã®æ°—åˆ†ã¯ï¼Ÿ", a:"ã‚­ãƒ¬é‡è¦–ï¼ˆã•ã£ã±ã‚Šï¼‰", b:"ã‚³ã‚¯é‡è¦–ï¼ˆæ¿ƒåšï¼‰"},
  {text:"â€œé‡ã‚’ã—ã£ã‹ã‚Šâ€é£Ÿã¹ã‚‹ãªã‚‰ï¼Ÿ", a:"è»½ã‚ã®èµ¤èº«ä¸­å¿ƒã§é€²ã‚ãŸã„", b:"æº€è¶³æ„Ÿã®é«˜ã„éƒ¨ä½ã§æŠ¼ã—ãŸã„"},
  {text:"åç‰©ã‹ã‚‰é¸ã¶ãªã‚‰ï¼Ÿ", a:"ãƒ’ãƒ¬ï¼ã‚¿ãƒ³ãªã©â€œèµ¤èº«å¯„ã‚Šâ€", b:"ã‚µãƒ¼ãƒ­ã‚¤ãƒ³ï¼ã‚«ãƒ«ãƒ“ãªã©â€œã‚³ã‚¯å¯„ã‚Šâ€"},
  {text:"1çš¿ã ã‘è¿½åŠ ã€‚è¿·ã£ãŸã‚‰ã©ã£ã¡ï¼Ÿ", a:"èµ¤èº«ç³»ã§ã‚‚ã†ä¸€çš¿", b:"ãƒªãƒƒãƒç³»ã§ã‚‚ã†ä¸€çš¿"},
  {text:"åˆã‚ã¦ã®åº—ã®ã‚ªãƒ¼ãƒ€ãƒ¼æ–¹é‡", a:"å®šç•ªãƒ¡ãƒ‹ãƒ¥ãƒ¼ä¸­å¿ƒ", b:"é™å®šãƒ»å‰µä½œã‚‚å°‘ã—"},
  {text:"ãƒ¡ã‚¤ãƒ³ã®ä¸€çš¿ã€æº€è¶³åº¦å„ªå…ˆãªã‚‰", a:"ãƒ’ãƒ¬ãƒ»ãƒ©ãƒ³ãƒ—ãªã©èµ¤èº«", b:"ãƒªãƒ–ãƒ­ãƒ¼ã‚¹ãƒ»ã‚µãƒ¼ãƒ­ã‚¤ãƒ³"},
  {text:"ãƒœãƒªãƒ¥ãƒ¼ãƒ æ„Ÿã€ç†æƒ³ã¯", a:"æ§ãˆã‚å¤šå“ç›®", b:"é‡æ„Ÿã§OK"},
  {text:"ç„¼ãã®å¥½ã¿", a:"ãƒ¬ã‚¢å¯„ã‚Šã§é¦™ã‚Šã‚’ç”Ÿã‹ã™", b:"ã—ã£ã‹ã‚Šç«å…¥ã‚Œã§ç”˜ã¿ã‚’å‡ºã™"},
  {text:"å‘³ä»˜ã‘ã®åˆæ‰‹", a:"å¡©ã§ç´ ææ¨ã—", b:"ç‰¹è£½ã‚½ãƒ¼ã‚¹ã§é«˜æšæ„Ÿ"},
  {text:"é¦™ã‚Šã®æ¼”å‡º", a:"ç‚­ãƒ»é¦™ã°ã—ã•ã§å¼•ãç· ã‚", b:"ãƒã‚¿ãƒ¼ã§é¦™ã‚Šãƒªãƒƒãƒã«"},
  {text:"å¸­ã®é›°å›²æ°—", a:"è½ã¡ç€ã„ã¦ä¼šè©±ã‚’æ•´ç†ã—ãŸã„", b:"è³‘ã‚„ã‹ã«ãƒ†ãƒ³ãƒè‰¯ã"},
  {text:"å†™çœŸ or ä¼šè©±", a:"å†™çœŸã¯æ§ãˆã‚ã€ä½“é¨“é‡è¦–", b:"å†™çœŸã‚„å‹•ç”»ã‚‚æ¥½ã—ã‚€"},
  {text:"ã‚·ã‚§ã‚¢ã®ä»•æ–¹", a:"å°‘é‡Ã—å¤šç¨®é¡ã§æ¯”è¼ƒé£Ÿã¹", b:"å°‘é‡é«˜æº€è¶³ã§å³é¸"},
  {text:"å½¹å›ã‚Š", a:"ç„¼ãæ‹…å½“ã§è¦‹å®ˆã‚‹", b:"ä¹¾æ¯ã‚„éŸ³é ­ã§ç››ã‚Šä¸Šã’ã‚‹"},
  {text:"ç· ã‚ã¯", a:"è»½ãä½™ç™½ã‚’æ®‹ã™", b:"ã—ã£ã‹ã‚Šæº€è…¹ã§ç· ã‚ã‚‹"},
  {text:"åˆå¯¾é¢ã®ä¼šè©±", a:"1ã¤æ·±ã„è©±ã‚’ä¸å¯§ã«", b:"ãƒ†ãƒ³ãƒè‰¯ãåºƒãæµ…ã"},
  {text:"åº—ã‹ã‚‰ã®ææ¡ˆ", a:"å¡©â†’ã‚¿ãƒ¬ã®ãƒ¡ãƒªãƒãƒªé‡è¦–", b:"æ˜ ãˆã®ã‚ã‚‹æ¼”å‡ºã‚‚æ­“è¿"},
  {text:"ä»–å“ã¨ã®é–¢ã‚ã‚Š", a:"é™ã‹ã«è‡ªåˆ†ãŸã¡ã®ä¸–ç•Œã§", b:"ã•ã‚Šã’ãªãè¼ªã‚’åºƒã’ãŸã„"},
  {text:"ãƒ†ãƒ¼ãƒ–ãƒ«é‹ç”¨", a:"æ®µå–ã‚Šã‚ˆã‚Šã‚‚ã‚†ã£ãŸã‚Š", b:"ä¼šè¨ˆã‚„å¸­æ›¿ãˆãªã©ä¸»å°"},
  {text:"ãŠã‹ã‚ã‚Šã®åˆ¤æ–­", a:"æ§˜å­ã‚’è¦‹ã¦æ§ãˆã‚ã«", b:"å‹¢ã„ã®ã¾ã¾ã„ããŸã„"},
];

const PAGE_SIZE = 5;
const TOTAL = QUESTIONS.length;

let page = 0;                      // 0..3
const answers = Array(TOTAL).fill(0); // 0=æœªå›ç­”, 1..5=é¸æŠ
let focusQ = 0;                    // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã§é¸ã¶å¯¾è±¡

const $grid = document.getElementById('grid');
const $bar  = document.getElementById('bar');
const $label= document.getElementById('progressLabel');
const $steps= document.getElementById('steps');
const $prev = document.getElementById('prev');
const $next = document.getElementById('next');
const $result = document.getElementById('result');

/* ---------- ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚° ---------- */
function renderSteps(){
  $steps.innerHTML = '';
  const pages = Math.ceil(TOTAL/PAGE_SIZE);
  for(let i=0;i<pages;i++){
    const s=document.createElement('span');
    if(i===page) s.classList.add('active');
    $steps.appendChild(s);
  }
}
function render(){
  // é€²æ—
  const answered = answers.filter(v=>v>0).length;
  $bar.style.width = (answered/TOTAL*100)+'%';
  $label.textContent = `${answered} / ${TOTAL}`;

  // ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«
  $prev.disabled = page===0;
  const allAnsweredThisPage = answers
    .slice(page*PAGE_SIZE, page*PAGE_SIZE+PAGE_SIZE)
    .every(v=>v>0);
  const lastPage = page === Math.floor((TOTAL-1)/PAGE_SIZE);
  $next.style.display   = lastPage ? 'none' : 'inline-flex';
  $result.style.display = lastPage ? 'inline-flex' : 'none';
  $next.disabled   = !allAnsweredThisPage;
  $result.disabled = answered<TOTAL;

  // ã‚°ãƒªãƒƒãƒ‰
  $grid.innerHTML='';
  const start = page*PAGE_SIZE;
  const end   = Math.min(start+PAGE_SIZE, TOTAL);
  for(let i=start;i<end;i++){
    $grid.appendChild(renderCard(i));
  }
  renderSteps();
}
function renderCard(i){
  const q = QUESTIONS[i];
  const wrap = document.createElement('section');
  wrap.className = 'card';

  const head = document.createElement('div');
  head.className = 'qhead';
  head.innerHTML = `<span class="pill">Q${i+1} / ${TOTAL}</span>`;
  wrap.appendChild(head);

  const title = document.createElement('div');
  title.className = 'title';
  title.textContent = q.text;
  wrap.appendChild(title);

  const labels = document.createElement('div');
  labels.className='labels';
  labels.innerHTML = `<span>ğŸ…°ï¸ ${q.a}</span><span>ğŸ…±ï¸ ${q.b}</span>`;
  wrap.appendChild(labels);

  const dots = document.createElement('div');
  dots.className='dots';
  for(let v=1; v<=5; v++){
    const b = document.createElement('button');
    b.className = 'dot';
    b.setAttribute('data-v', v);
    b.setAttribute('aria-label', `Q${i+1}: ${v} ã‚’é¸ã¶`);
    if(answers[i]===v) b.classList.add('active');
    b.addEventListener('click', ()=>{
      answers[i]=v;
      focusQ=i;
      // é¸ã‚“ã ã‚‰è‡ªå‹•çš„ã«æ¬¡ã®æœªå›ç­”ã¸è¦–ç·šç§»å‹•
      render();
      autoAdvanceFrom(i);
    });
    dots.appendChild(b);
  }
  wrap.appendChild(dots);

  const scale = document.createElement('div');
  scale.className='scale-help';
  scale.innerHTML = `<span>Aå¯„ã‚Š</span><span>ä¸­ç«‹</span><span>Bå¯„ã‚Š</span>`;
  wrap.appendChild(scale);

  return wrap;
}
function autoAdvanceFrom(i){
  // ä»Šã®ãƒšãƒ¼ã‚¸å†…ã§æœªå›ç­”ãŒã‚ã‚Œã°ãã“ã¾ã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
  const start = page*PAGE_SIZE, end=Math.min(start+PAGE_SIZE, TOTAL);
  let nextIndex = -1;
  for(let k=i+1; k<end; k++){ if(answers[k]===0){ nextIndex=k; break; } }
  if(nextIndex===-1){
    for(let k=start; k<i; k++){ if(answers[k]===0){ nextIndex=k; break; } }
  }
  if(nextIndex>-1){
    const idxOnPage = nextIndex - start;
    const sec = $grid.children[idxOnPage];
    sec?.scrollIntoView({behavior:'smooth', block:'nearest'});
    focusQ = nextIndex;
  }else{
    // ã™ã¹ã¦å›ç­”æ¸ˆã¿ãªã‚‰æ¬¡ã¸ãƒœã‚¿ãƒ³ã‚’ç‚¹ç¯
    if(page < Math.floor((TOTAL-1)/PAGE_SIZE)){
      $next.focus();
    }else{
      $result.focus();
    }
  }
}

/* ---------- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ ---------- */
$prev.addEventListener('click', ()=>{ if(page>0){ page--; render(); window.scrollTo({top:0,behavior:'smooth'}); }});
$next.addEventListener('click', ()=>{ const maxPage=Math.floor((TOTAL-1)/PAGE_SIZE); if(page<maxPage){ page++; render(); window.scrollTo({top:0,behavior:'smooth'});} });

/* ---------- ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰é¸æŠ (1..5) ---------- */
document.addEventListener('keydown', (e)=>{
  if(e.key<'1'||e.key>'5') return;
  const val = parseInt(e.key,10);
  // æœªå›ç­”ã®æœ€åˆã‚’ãƒ•ã‚©ãƒ¼ã‚«ã‚¹å¯¾è±¡ã«
  if(answers[focusQ] && answers[focusQ]>0){
    const firstUnanswered = answers.findIndex(v=>v===0);
    if(firstUnanswered>=0) focusQ = firstUnanswered;
  }
  answers[focusQ]=val;
  render();
  autoAdvanceFrom(focusQ);
});

/* ---------- çµæœä¿å­˜â†’é·ç§» ---------- */
function saveAndGo(){
  const payload = {
    version: 'v3',
    created_at: Date.now(),
    answers: answers.slice(0, TOTAL),
    // ã“ã“ã§ã¯é›†è¨ˆã¯è¡Œã‚ãšã€çµæœãƒšãƒ¼ã‚¸ã§è¨ˆç®—ã™ã‚‹æƒ³å®š
  };
  // äº’æ›ã®ãŸã‚è¤‡æ•°ã‚­ãƒ¼ã¸ä¿å­˜
  const json = JSON.stringify(payload);
  localStorage.setItem('meatbti_answers', json);
  localStorage.setItem('meatbti_v2_answers', json);
  localStorage.setItem('meatbti_payload', json);
  // ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆï¼ˆæ—¢å­˜æ§‹æˆã«åˆã‚ã›ã¦ sub.html ã«ï¼‰
  location.href = 'sub.html';
}
$result.addEventListener('click', ()=>{
  if(answers.some(v=>v===0)){ alert('æœªå›ç­”ãŒã‚ã‚Šã¾ã™ã€‚'); return; }
  saveAndGo();
});

/* åˆæœŸè¡¨ç¤º */
render();
</script>
</body>
</html>
